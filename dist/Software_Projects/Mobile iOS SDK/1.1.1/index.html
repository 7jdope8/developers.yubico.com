<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>1.1.1</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li class="active"><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/Software_Projects">Software Projects</a></li>
<li><a href="/Software_Projects/Mobile iOS SDK">Mobile iOS SDK</a></li>
<li class="active">1.1.1</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/Software_Projects">Software Projects</a><ul class="">
<li><a href="/Software_Projects/Yubico_OTP">Yubico OTP</a></li>
<li><a href="/Software_Projects/FIDO_U2F">FIDO U2F</a></li>
<li><a href="/Software_Projects/YubiKey_Device_Configuration">YubiKey Device Configuration</a></li>
<li><a href="/Software_Projects/YubiHSM">YubiHSM</a></li>
<li><a href="/Software_Projects/FIDO2">FIDO2</a></li>
<li class="active"><a href="/Software_Projects/Mobile iOS SDK">Mobile iOS SDK</a><ul class="">
<li><a href="/Software_Projects/Mobile iOS SDK/YubiKey for Lightning Program">YubiKey for Lightning Program</a></li>
<li class="active"><a href="/Software_Projects/Mobile iOS SDK/1.1.1">1.1.1</a><ul class="">
<li><a href="/Software_Projects/Mobile iOS SDK/1.1.1/Changelog">Changelog</a></li>
</ul>
</li></ul>
<li><a href="/Software_Projects/Software_Signing.html">Software Signing</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul></ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_mobile_ios_sdk">Mobile iOS SDK</h1>
<div class="sectionbody">
<div class="sect2">
<h3 id="_yubikit_1_1_1">YubiKit 1.1.1</h3>
<div class="paragraph"><p><strong>YubiKit</strong> is an iOS library provided by Yubico to interact with YubiKeys. The library supports NFC-enabled YubiKeys, and provides APIs to request an OTP (Yubico OTP or HOTP) from the key using a NFC-enabled iOS [1]. The library provides also a built-in QR Code reader which can be used as an alternative enrolment mechanism for iOS devices which don’t support NFC reading.</p></div>
<div class="paragraph"><p>The library comes with a demo application which shows a complete example of how to integrate and use the library in a project.</p></div>
<div class="paragraph"><p>1 <em>Due to some restrictions of the CoreNFC framework on iOS, the library doesn’t have support for TOTP.</em></p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph"><p><strong>YubiKit</strong> requires access to NFC to interact with an NFC-enabled YubiKey. NFC reading is available as an API since iOS 11 on iPhone 7 and newer devices. The library provides capabilities check which can be used to detect if the device supports NFC reading or not.</p></div>
<div class="paragraph"><p>YubiKit is provided as a static library to maximise the compatibility with various projects written in Objective-C or Swift, using older or newer versions of Xcode. The library comes in two flavours, <strong>debug_universal</strong> and <strong>release</strong>. As the names suggest, the first one is intended for development use only, compatible with both the iOS simulator and real devices, while the release version must be used for release distributions, including AppStore/TestFlight, AdHoc and Enterprise.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_integration_steps">Integration steps</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_step_1_prepare_the_project">Step 1 - Prepare the project</h3>
<div class="paragraph"><p>Before adding the library, the project needs to have access to NFC and Camera, when using the built-in QR Code reader.</p></div>
<div class="paragraph"><p>The NFC support requires to add a new entitlement to the project, called <strong>Near Field Communication Tag Reading</strong>. To turn it on, Xcode provides an automatic way of doing it by selecting the desired target (usually the app target) and turning on the associated switch in the <strong>Capabilities</strong> tab. If the project has already an entitlements file for other features (like iCloud, Notifications etc.), the new entitlement will be added to the existing file. If the project doesn’t have an entitlements file, Xcode will create one and add it to the project. Additionally the new entitlement needs to be enabled on the AppId in the Developer portal. If possible, Xcode will do this automatically.</p></div>
<div class="paragraph"><p><strong>Note:</strong>
If the entitlement is not enabled the iOS SDK will hang up the main thread on startup and eventually will fail after some time, when the application is trying to access the NFC APIs.</p></div>
<div class="paragraph"><p>After enabling the entitlement, iOS requires from the application to provide a NFC usage description defined in the <em>info.plist</em> file. To add it follow the standard way of adding a new key to the info.plist and search for <strong>Privacy - NFC Scan Usage Description</strong>. This property is a string describing the intent for using NFC.</p></div>
<div class="paragraph"><p>If the application is using the built-in QR Code reader, since iOS 10 the application needs to provide a reason for accessing the camera. Add it in the same way as setting the description for NFC access, using <strong>Privacy - Camera Usage Description</strong> key instead. This value will be shown during camera permission request dialog, displayed by the OS.</p></div>
<div class="paragraph"><p><strong>Note:</strong>
The iOS 11 SDK doesn’t display a permission dialog before giving access to NFC, even it requires a NFC usage description in <em>info.plist</em>.</p></div>
</div>
<div class="sect2">
<h3 id="_step_2_add_the_library">Step 2 - Add the library</h3>
<div class="paragraph"><p>The library is archived into a zip file named YubiKit[version] where version is the version number of the packed library. Follow the next steps to add the library to the project:</p></div>
<div class="ulist"><ul>
<li>
<p>
Unzip the library archive. After unzipping the result is a folder which contains two other folders <strong>YubiKit</strong>, the library folder, and <strong>YubiKitDemo</strong>, the demo app for the library.
</p>
</li>
<li>
<p>
Copy the <strong>YubiKit</strong> folder into the target project folder.
</p>
</li>
<li>
<p>
In the project select the app target and in the <strong>General</strong> tab look for <strong>Linked Frameworks and Libraries</strong>. Click + and select <strong>Add Other</strong>. Locate the <strong>libYubiKit.a</strong> in <strong>YubiKit/debug_universal</strong> folder and add it.
</p>
</li>
<li>
<p>
Select <strong>Build Settings</strong> tab for the target. Filter the settings by searching after <strong>Library search paths</strong> and expand the configuration to see both <strong>debug</strong> and <strong>release</strong>. Update the <strong>release</strong> path to point at the <strong>YubiKit/release</strong> folder of the library and the <strong>debug</strong> path to point at the <strong>YubiKit/debug_universal</strong> folder.
</p>
</li>
<li>
<p>
Filter the settings by <strong>Header search paths</strong>, add the path to the <strong>YubiKit</strong> folder, and make it recursive.
</p>
</li>
<li>
<p>
Filter the settings by <strong>Other Linker flags</strong> and add <strong>-ObjC</strong> to allow the linker to properly load categories from static libraries (Some projects have it by default).
</p>
</li>
</ul></div>
<div class="paragraph"><p>Now the application is able to link with libYubiKit.a and to properly select the right library flavour when building for debug or release.</p></div>
</div>
<div class="sect2">
<h3 id="_step_3_use_the_library">Step 3 - Use the library</h3>
<div class="paragraph"><p>Before using the library in Swift, it needs to be bridged. Add #import &lt;YubiKit/YubiKit.h&gt;; to the bridging header. If the bridging header is not available add one by following this <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html" rel="noopener noreferrer" target="_blank">documentation</a>.</p></div>
<div class="paragraph"><p>YubiKit provides the majority of its functionality through a single instance called YubiKitManager which is retrieved by accessing the YubiKitManager.shared property. YubiKitManager is a singleton and the library prevents an instance creation by the host application. YubiKitManager is structured to provide <em>sessions</em>, each one of them being dedicated to only one type of communication. For details look at the available properties on YubiKitManager.
1</p></div>
<div class="paragraph"><p>To request a NFC scan for an OTP token call requestOTPToken: on the nfcReaderSession instance from YubiKitManager:</p></div>
<div class="sect3">
<h4 id="_objective_c">Objective-C</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="cp">#import &lt;YubiKit/YubiKit.h&gt;</span>
<span class="p">...</span>
<span class="p">[</span><span class="n">YubiKitManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">nfcReaderSession</span> <span class="nl">requestOTPToken</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">id</span><span class="o">&lt;</span><span class="n">YKFOTPTokenProtocol</span><span class="o">&gt;</span> <span class="n">token</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">tokenValue</span> <span class="o">=</span> <span class="n">token</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
    <span class="c1">// Start using the token value</span>
    <span class="p">...</span>
<span class="p">}];</span>
</pre></div></div></div>
</div>
<div class="sect3">
<h4 id="_swift">Swift</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="n">YubiKitManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">nfcReaderSession</span><span class="p">.</span><span class="n">requestOTPToken</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="nb">self</span><span class="p">]</span> <span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">let</span> <span class="n">value</span> <span class="o">=</span> <span class="n">token</span><span class="o">?</span><span class="p">.</span><span class="n">value</span> <span class="p">{</span>
       <span class="c1">// Start using the token value</span>
       <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div>
<div class="paragraph"><p>The YKFOTPToken contains the details of the scanned OTP token. The detailed documentation of all the properties is available in the header files provided with the library.</p></div>
<div class="paragraph"><p>To request a QR Code scan call scanQrCodeWithPresenter:completion: on the qrReaderSession instance from YubiKitManager:</p></div>
</div>
<div class="sect3">
<h4 id="_objective_c_2">Objective-C</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="cp">#import &lt;YubiKit/YubiKit.h&gt;</span>
<span class="p">...</span>
<span class="c1">// Here self is a view controller.</span>
<span class="p">[</span><span class="n">YubiKitManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">qrReaderSession</span> <span class="nl">scanQrCodeWithPresenter</span><span class="p">:</span><span class="nb">self</span> <span class="nl">completion</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="n">payload</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Start using the payload</span>
    <span class="c1">// ...</span>
<span class="p">}];</span>
</pre></div></div></div>
</div>
<div class="sect3">
<h4 id="_swift_2">Swift</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="c1">// Here self is a view controller.</span>
<span class="n">YubiKitManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">qrReaderSession</span><span class="p">.</span><span class="n">scanQrCode</span><span class="p">(</span><span class="nl">withPresenter</span><span class="p">:</span> <span class="nb">self</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="nb">self</span><span class="p">]</span> <span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
    <span class="c1">// Start using the payload</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div></div></div>
<div class="paragraph"><p>In the current version of YubiKit the library doesn’t make any assumption about the format of the scanned QR code payload but this may change in future versions.</p></div>
<div class="paragraph"><p>Before calling the APIs for NFC or QR Code scanning it is recommended to check for the capabilities of the OS/Device. If the device or the OS does not support a capability <strong>the library will fire an assertion</strong> in debug builds when calling a method without having the required capability. YubiKit provides a handy utility class to check for these capabilities: YubiKitDeviceCapabilities:</p></div>
</div>
<div class="sect3">
<h4 id="_objective_c_3">Objective-C</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="cp">#import &lt;YubiKit/YubiKit.h&gt;</span>
<span class="p">...</span>
<span class="c1">// 1. NFC scanning is available</span>
<span class="k">if</span> <span class="p">(</span><span class="n">YubiKitDeviceCapabilities</span><span class="p">.</span><span class="n">supportsNFCScanning</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Provide additional setup when NFC is available</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Handle missing NFC</span>
<span class="p">}</span>

<span class="c1">// 2. QR Code scanning is available</span>
<span class="k">if</span> <span class="p">(</span><span class="n">YubiKitDeviceCapabilities</span><span class="p">.</span><span class="n">supportsQRCodeScanning</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Provide additional setup when QR Code scanning is available</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Handle missing QR</span>
<span class="p">}</span>
</pre></div></div></div>
</div>
<div class="sect3">
<h4 id="_swift_3">Swift</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">YubiKitDeviceCapabilities</span><span class="p">.</span><span class="n">supportsNFCScanning</span> <span class="p">{</span>
    <span class="c1">// Provide additional setup when NFC is available</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Handle missing NFC</span>
<span class="p">}</span>

<span class="k">if</span> <span class="n">YubiKitDeviceCapabilities</span><span class="p">.</span><span class="n">supportsQRCodeScanning</span> <span class="p">{</span>
    <span class="c1">// Provide additional setup when QR Code scanning is available</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Handle missing QR</span>
<span class="p">}</span>
</pre></div></div></div>
<div class="paragraph"><p>To allow the library to be linked with older projects, some of the APIs in YubiKit use availability annotations. One example is the presence of the NFC APIs available only from iOS 11. If the host application needs to run on older devices, by compiling the project for older versions of iOS, and still provide new features for users with newer devices, you can use @available/#available before calling the APIs which require iOS 11 and above.</p></div>
</div>
<div class="sect3">
<h4 id="_objective_c_4">Objective-C</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="cp">#import &lt;YubiKit/YubiKit.h&gt;</span>
<span class="p">...</span>
<span class="k">if</span> <span class="p">(@</span><span class="n">available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">11.0</span><span class="p">,</span> <span class="o">*</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// Call the NFC APIs</span>
<span class="p">}</span>
</pre></div></div></div>
</div>
<div class="sect3">
<h4 id="_swift_4">Swift</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="err">#</span><span class="n">available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">11.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Call the NFC APIs</span>
<span class="p">}</span>
</pre></div></div></div>
<div class="paragraph"><p><strong>Note:</strong>
To use <em>@available</em> in Obj-C the project needs to be compiled with Xcode 9 or newer.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_putting_everything_together">Putting everything together</h3>
<div class="sect3">
<h4 id="_objective_c_5">Objective-C</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="cp">#import &lt;YubiKit/YubiKit.h&gt;</span>
<span class="p">...</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">requestOTPToken</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">YubiKitDeviceCapabilities</span><span class="p">.</span><span class="n">supportsNFCScanning</span><span class="p">)</span> <span class="p">{</span>
       <span class="c1">// The device does not support NFC reading</span>
       <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(@</span><span class="n">available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">11.0</span><span class="p">,</span> <span class="o">*</span><span class="p">))</span> <span class="p">{</span>
       <span class="p">[</span><span class="n">YubiKitManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">nfcReaderSession</span> <span class="nl">requestOTPToken</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">id</span><span class="o">&lt;</span><span class="n">YKFOTPTokenProtocol</span><span class="o">&gt;</span> <span class="n">token</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// Process error</span>
          <span class="k">return</span><span class="p">;</span>
         <span class="p">}</span>
         <span class="c1">// Process token</span>
       <span class="p">}];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">requestQRCodeScan</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">YubiKitDeviceCapabilities</span><span class="p">.</span><span class="n">supportsQRCodeScanning</span><span class="p">)</span> <span class="p">{</span>
       <span class="c1">// The device does not support QR code scanning</span>
       <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">[</span><span class="n">YubiKitManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">qrReaderSession</span> <span class="nl">scanQrCodeWithPresenter</span><span class="p">:</span><span class="nb">self</span> <span class="nl">completion</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="n">payload</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">// Process error</span>
         <span class="k">return</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="c1">// Process payload</span>
    <span class="p">}];</span>
<span class="p">}</span>
</pre></div></div></div>
</div>
<div class="sect3">
<h4 id="_swift_5">Swift</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="n">func</span> <span class="nf">requestOTPToken</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">guard</span> <span class="n">YubiKitDeviceCapabilities</span><span class="p">.</span><span class="n">supportsNFCScanning</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// The device does not support NFC reading</span>
        <span class="k">return</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="err">#</span><span class="n">available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">11.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">YubiKitManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">nfcReaderSession</span><span class="p">.</span><span class="n">requestOTPToken</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="nb">self</span><span class="p">]</span> <span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
            <span class="n">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="nb">nil</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Process error</span>
                <span class="k">return</span>
            <span class="p">}</span>
            <span class="c1">// Process token</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">func</span> <span class="nf">requestQRCodeScan</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">guard</span> <span class="n">YubiKitDeviceCapabilities</span><span class="p">.</span><span class="n">supportsQRCodeScanning</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// The device does not support QR code scanning</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="n">YubiKitManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">qrReaderSession</span><span class="p">.</span><span class="n">scanQrCode</span><span class="p">(</span><span class="nl">withPresenter</span><span class="p">:</span> <span class="nb">self</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="nb">self</span><span class="p">]</span> <span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
        <span class="n">guard</span> <span class="n">error</span> <span class="o">==</span> <span class="nb">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// Process error</span>
            <span class="k">return</span>
        <span class="p">}</span>
        <span class="c1">// Process payload</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div>
</div>
</div>
<div class="sect2">
<h3 id="_customising_yubikit">Customising YubiKit</h3>
<div class="paragraph"><p>YubiKit allows customising some of its behaviour by using YubiKitConfiguration and YubiKitExternalLocalization.</p></div>
<div class="paragraph"><p>For providing localised strings for the user facing messages shown by the library, YubiKit provides a collection of properties in YubiKitExternalLocalization.</p></div>
<div class="paragraph"><p>One example of a localised string is the message shown in the NFC scanning UI while the device waits for a YubiKey to be scanned. This message can be localised by setting the value of nfcScanAlertMessage:</p></div>
<div class="sect3">
<h4 id="_objective_c_6">Objective-C</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="cp">#import &lt;YubiKit/YubiKit.h&gt;</span>
<span class="p">...</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">localizedAlertMessage</span> <span class="o">=</span> <span class="n">NSLocalizedString</span><span class="p">(</span><span class="s">@"NFC_SCAN_MESSAGE"</span><span class="p">,</span> <span class="s">@"Scan your YubiKey."</span><span class="p">);</span>
<span class="n">YubiKitExternalLocalization</span><span class="p">.</span><span class="n">nfcScanAlertMessage</span> <span class="o">=</span> <span class="n">localizedNfcScanAlertMessage</span><span class="p">;</span>
</pre></div></div></div>
</div>
<div class="sect3">
<h4 id="_swift_6">Swift</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="n">let</span> <span class="n">localizedAlertMessage</span> <span class="o">=</span> <span class="n">NSLocalizedString</span><span class="p">(</span><span class="s">"NFC_SCAN_MESSAGE"</span><span class="p">,</span> <span class="nl">comment</span><span class="p">:</span> <span class="s">"Scan your YubiKey."</span><span class="p">)</span>
<span class="n">YubiKitExternalLocalization</span><span class="p">.</span><span class="n">nfcScanAlertMessage</span> <span class="o">=</span> <span class="n">localizedAlertMessage</span>
</pre></div></div></div>
<div class="paragraph"><p>For all the available properties and their use look at the code documentation for YubiKitExternalLocalization.</p></div>
<div class="paragraph"><p><strong>Note:</strong>
YubiKitExternalLocalization provides default values in English (en-US), which are useful only for debugging and prototyping. For production code always provide localised values.</p></div>
<div class="paragraph"><p>In some conditions the NDEF payload format from a YubiKey can be modified and may have a custom way of appending metadata (as Text or URI) to the OTP token. In such a scenario, when the payload has a complex or non-standard format, the library allows the host application to provide a custom parser for the payload.</p></div>
<div class="paragraph"><p>The YubiKey can append two types of metadata to the OTP token: <strong>Text</strong> or <strong>URI</strong> (default one). To provide custom parsers the host application can use YKFOTPURIParserProtocol for a custom URI Parser and YKFOTPTextParserProtocol for a custom text parser. The code level documentation provides additional details on what the parsers should implement.</p></div>
<div class="paragraph"><p>Here is an example of how to set a custom URI parser:</p></div>
</div>
<div class="sect3">
<h4 id="_objective_c_7">Objective-C</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="cp">#import &lt;YubiKit/YubiKit.h&gt;</span>
<span class="p">...</span>
<span class="k">@interface</span> <span class="nc">CustomURIParser</span>: <span class="bp">NSObject</span><span class="o">&lt;</span><span class="n">YKFOTPURIParserProtocol</span><span class="o">&gt;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">CustomURIParser</span>
    <span class="c1">// Custom parser implementation</span>
<span class="k">@end</span>
<span class="p">...</span>
<span class="n">YubiKitConfiguration</span><span class="p">.</span><span class="n">customOTPURIParser</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CustomURIParser</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</pre></div></div></div>
</div>
<div class="sect3">
<h4 id="_swift_7">Swift</h4>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nl">CustomURIParser</span><span class="p">:</span> <span class="n">YKFOTPURIParserProtocol</span> <span class="p">{</span>
    <span class="c1">// Custom parser implementation</span>
<span class="p">}</span>
<span class="p">...</span>
<span class="n">YubiKitConfiguration</span><span class="p">.</span><span class="n">customOTPURIParser</span> <span class="o">=</span> <span class="n">CustomURIParser</span><span class="p">()</span>
</pre></div></div></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_demo_application">Using the demo application</h2>
<div class="sectionbody">
<div class="paragraph"><p>The library comes with a demo application named <strong>YubiKitDemo</strong>. The application is implemented in Swift 4 (Xcode 9) and it shows a complete example on how to use the library. Also the demo app shows how the library is linked to a project so it can be used as a side by side comparison when adding the library to another project.</p></div>
<div class="paragraph"><p>YubiKit headers are documented and the documentation is also available using the QuickHelp from Xcode (Option + Click symbol). Use this documentation for a more detailed explanation of all the methods, properties and parameters from the API.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_resources">Additional resources</h2>
<div class="sectionbody">
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Xcode Help <a href="http://help.apple.com/xcode/mac/current/#/dev88ff319e7" rel="noopener noreferrer" target="_blank">Add a capability to a target</a>
</p>
</li>
<li>
<p>
Xcode Help <a href="http://help.apple.com/xcode/mac/current/#/itcaec37c2a6" rel="noopener noreferrer" target="_blank">Build settings reference</a>
</p>
</li>
<li>
<p>
Technical Q&amp;A QA1490
<a href="https://developer.apple.com/library/content/qa/qa1490/_index.html" rel="noopener noreferrer" target="_blank">Building Objective-C static libraries with categories</a>
</p>
</li>
<li>
<p>
Apple Developer <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html" rel="noopener noreferrer" target="_blank">Swift and Objective-C in the Same Project</a>
</p>
</li>
<li>
<p>
Yubico <a href="https://developers.yubico.com">Developers</a>
</p>
</li>
<li>
<p>
Yubico <a href="https://demo.yubico.com" rel="noopener noreferrer" target="_blank">Online Demo</a>
</p>
</li>
</ol></div>
</div>
</div>
<div class="sect1">
<h2 id="_sign_up_to_get_access_to_the_mobile_ios_sdk">Sign up to get access to the Mobile iOS SDK</h2>
<div class="sectionbody">
<div class="paragraph"><p>To get access to the Mobile iOS SDK <a href="https://www.yubico.com/why-yubico/for-developers/mobile-sdk-ios-sign-up/" rel="noopener noreferrer" target="_blank">sign up here</a>.</p></div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>