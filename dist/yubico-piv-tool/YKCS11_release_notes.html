<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>YKCS11 release notes</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/yubico-piv-tool">yubico-piv-tool</a></li>
<li class="active">YKCS11 release notes</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/yubico-piv-tool">yubico-piv-tool</a><ul class="">
<li><a href="/yubico-piv-tool/Release_Notes.html">Release Notes</a></li>
<li><a href="/yubico-piv-tool/Attestation.html">Attestation</a></li>
<li class="active"><a href="/yubico-piv-tool/YKCS11_release_notes.html">YKCS11 release notes</a>
<li><a href="/yubico-piv-tool/YubiKey_PIV_introduction.html">YubiKey PIV introduction</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/yubico-piv-tool" rel="noopener noreferrer" target="_blank"><i class="fa fa-github fa-lg"></i> Github</a></li>
</ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_ykcs11">YKCS11</h1>
<div class="sectionbody">
<div class="paragraph"><p>This is a PKCS#11 module that allows to communicate with the PIV
application running on a YubiKey.</p></div>
<div class="paragraph"><p>This module is based on version 2.40 of the PKCS#11 (Cryptoki)
specifications.</p></div>
<div class="paragraph"><p>The complete specifications are available at
<a href="https://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.html" rel="noopener noreferrer" target="_blank">https://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.html</a>.</p></div>
<div class="sect2">
<h3 id="_building">BUILDING</h3>
<div class="paragraph"><p>YKCS11 is automatically built as part of <code>yubico-piv-tool</code> and the
following command will suffice:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>autoreconf --install
<span class="sh-dollar"></span>./configure
<span class="sh-dollar"></span>make
<span class="sh-dollar"></span>sudo make install
</pre>
</div></div>
<div class="paragraph"><p>More info about building yubico-piv-tool can be found in the related
<code>README</code> file or over at
<a href="https://developers.yubico.com/yubico-piv-tool/">https://developers.yubico.com/yubico-piv-tool/</a>.</p></div>
<div class="paragraph"><p>Once installed, the module will be found by default in
/usr/local/lib/libykcs11.so otherwise it will be built locally in
yubico-piv-tool/ykcs11/.libs/libykcs11.so</p></div>
</div>
<div class="sect2">
<h3 id="_portability">PORTABILITY</h3>
<div class="paragraph"><p>The module has been developed and tested using Debian GNU/Linux and
Ubuntu Linux. It is however possible to cross-compile it for Windows
and Mac OS X using the relative makefiles (windows.mk and mac.mk).
Both use PCSC as a backend.</p></div>
<div class="paragraph"><p>Keep in mind that communication with the YubiKey is carried out over
the CCID transport. Hence, on Mac OS X the YubiKey should be
whitelisted (more info at <a href="https://github.com/Yubico/ifd-yubico" rel="noopener noreferrer" target="_blank">https://github.com/Yubico/ifd-yubico</a>).</p></div>
<div class="paragraph"><p>Further testing at this stage has <strong>not</strong> been carried out, so
additional tweaks might be needed to use operating systems different
from Linux.</p></div>
</div>
<div class="sect2">
<h3 id="_supported_functionality_and_known_issues">SUPPORTED FUNCTIONALITY AND KNOWN ISSUES</h3>
<div class="paragraph"><p>YKCS11 is not a full implementation of PKCS#11. Some functionality are
not present and others are not yet implemented.</p></div>
<div class="paragraph"><p>In its current form YKCS11 implements a smaller subset of
functionality:</p></div>
<div class="ulist"><ul>
<li>
<p>
RSA key generation<br>
  1024 or 2048 bit keys can be generated;
</br></p>
</li>
<li>
<p>
EC key generation<br>
  curve prime256v1 is supported (256 bit keys);
</br></p>
</li>
<li>
<p>
RSA signature<br>
  supported mechanisms are RSA-X-509 (raw RSA), PKCS1 (unhashed),
  PKCS1 with SHA1/256/384/512 and PSS with SHA1/256/384/512. The
  latter is implemented but has not been tested, hence is provided as
  is;
</br></p>
</li>
<li>
<p>
ECDSA signature<br>
  supported mechanism are ECDSA (raw) and ECDSA with SHA1;
</br></p>
</li>
<li>
<p>
RSA and EC public key (X.509 certificate) import;
</p>
</li>
<li>
<p>
RSA and EC private key import<br>
  with possibility of setting individual PIN policies and touch to
  sign (where supported);
</br></p>
</li>
<li>
<p>
Public key deletion.
</p>
</li>
</ul></div>
<div class="paragraph"><p>PKCS#11 defines two types of users: a regular user and a security
officer (SO). These have been mapped to perform regular usage of the
private key material (PIN-associated operations) and device management
(management-key associated operations).</p></div>
<div class="sect3">
<h4 id="_key_mapping">Key Mapping</h4>
<div class="paragraph"><p>The module provides four main keys that can be used. These correspond
to the four main keys in PIV and accessible through yubico-piv-tool.
The mapping is as follows:</p></div>
<table class="table table-bordered table-striped tableblock frame-all grid-all" style="
width:100%;
">
<col style="width:50%;">
<col style="width:50%;">
<thead>
<tr>
<th class="tableblock halign-center valign-top">ykcs11 id</th>
<th class="tableblock halign-center valign-top">PIV</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">9a</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">9e</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">9c</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">9d</p></td>
</tr>
</tbody>
</col></col></table>
</div>
<div class="sect3">
<h4 id="_pins_and_management_key">PINs and Management Key</h4>
<div class="paragraph"><p>The default user PIN for the YubiKey is <code>123456</code>.<br>
The default management key is
<code>010203040506070801020304050607080102030405060708</code>.<br>
All the YubiKey personalization (e.g. changing PIN, changing
management key, resetting PINs, resetting the application) is
currently done using yubico-piv-tool.</br></br></p></div>
<div class="paragraph"><p>In order to perform operations involving the private keys, a regular
user must be logged in (i.e. using the PIN). However, given the
different PIN policies for different keys, subsequent operations might
require a new login. Currently this is supported by the module
allowing multiple <em>Login</em> operations with the appropriate user.
According to PKCS#11 however, a special user called <code>CONTEXT_SPECIFIC</code>
should be used for such operations. This is also supported and <strong>might
become the only available mechanism in the future</strong>.</p></div>
</div>
<div class="sect3">
<h4 id="_key_generation">Key Generation</h4>
<div class="paragraph"><p>Key pair generation is a particular operation, in the sense that
within PIV this is the only moment where the newly created public key
is given back to the user. To prevent the key from being lost it is
automatically stored within the YubiKey by wrapping it in an X.509
certificate. This certificate is however empty. It does not have other
valid information except for the public key.</p></div>
</div>
<div class="sect3">
<h4 id="_debugging">DEBUGGING</h4>
<div class="paragraph"><p>By default the module has debugging disabled. This is <em>highly</em> verbose
and might be confusing. In order to enabled it rebuild the project as
follows:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>autoreconf --install
<span class="sh-dollar"></span>./configure --enable-ykcs11-debug
<span class="sh-dollar"></span>make
<span class="sh-dollar"></span>sudo make install
</pre>
</div></div>
</div>
</div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>