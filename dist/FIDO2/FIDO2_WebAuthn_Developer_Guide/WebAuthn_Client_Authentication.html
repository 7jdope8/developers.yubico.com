<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>WebAuthn Client Authentication</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li class="active"><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/FIDO2">FIDO2</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide">FIDO2 WebAuthn Developer Guide</a></li>
<li class="active">WebAuthn Client Authentication</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/FIDO2">FIDO2</a><ul class="">
<li class="active"><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide">FIDO2 WebAuthn Developer Guide</a><ul class="">
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Overview.html">Overview</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/WebAuthn_Client_Registration.html">WebAuthn Client Registration</a></li>
<li class="active"><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/WebAuthn_Client_Authentication.html">WebAuthn Client Authentication</a>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/WebAuthn_Server_Overview.html">WebAuthn Server Overview</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/WebAuthn_Server_Registration.html">WebAuthn Server Registration</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Attestation.html">Attestation</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Resident_Keys.html">Resident Keys</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Registering_Multiple_Devices.html">Registering Multiple Devices</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/WebAuthn_Server_Authentication.html">WebAuthn Server Authentication</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Federation.html">Federation</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Account_Recovery.html">Account Recovery</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Migrating_from_U2F.html">Migrating from U2F</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Desktop_and_Mobile_Authentication.html">Desktop and Mobile Authentication</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/FAQ.html">FAQ</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Resources.html">Resources</a></li>
<li><a href="/FIDO2/FIDO2_WebAuthn_Developer_Guide/Terminology.html">Terminology</a></li>
</li></ul>
<li><a href="/FIDO2/Libraries">Libraries</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/developers.yubico.com/issues/new?title=Suggested%20edit%20for%20FIDO2/FIDO2_WebAuthn_Developer_Guide/WebAuthn_Client_Authentication" rel="noopener noreferrer" target="_blank"><i class="fa fa-pencil-square-o fa-lg"></i> Suggest Edits</a></li>
</ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_webauthn_client_authentication">WebAuthn Client Authentication</h1>
<div class="sectionbody">
<div class="paragraph"><p>The RP can also request the user’s permission to perform an authentication operation with an existing credential. The authentication flow looks similar to the registration flow. The primary differences are:</p></div>
<div class="ulist"><ul>
<li>
<p>
Authentication does not require user information
</p>
</li>
<li>
<p>
Authentication creates an assertion signed by the previously generated private key that is associated with the relying party rather than signing with the attestation certificate.
</p>
</li>
</ul></div>
<div class="imageblock">
<div class="content">
<img alt="webauthn-authentication-flow-01.svg?sanitize=true" src="webauthn-authentication-flow-01.svg?sanitize=true">
</img></div>
</div>
<div class="paragraph"><p><a href="https://www.w3.org/TR/webauthn/images/webauthn-authentication-flow-01.svg" rel="noopener noreferrer" target="_blank">W3C WebAuthn Authentication Flow Figure</a></p></div>
<div class="sect2">
<h3 id="_authentication_flow">Authentication Flow</h3>
<div class="paragraph"><p><strong>0.</strong> The client initiates a request to authenticate on behalf of the user.</p></div>
<div class="paragraph"><p><strong>1.</strong> The RP builds an instance of the <code>PublicKeyCredentialRequestOptions</code> and returns it to the client. It contains the <code>challenge</code> and the <code>allowCredentials</code> field which contains a list of previously registered credentials that may be used to perform the authentication ceremony.</p></div>
<div class="sect3">
<h4 id="_example">Example</h4>
<div class="paragraph"><p><strong>Parsed PublicKeyCredentialRequestOptions</strong></p></div>
<div class="paragraph"><p><em>Note: In the WebAuthn API, all binary parameters (<code>id</code>, <code>challenge</code> etc.) are actually `UintArray`s and not Base64 strings. This example displays them as Base64 strings for readability</em></p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"publicKey"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"allowCredentials"</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"X9FrwMfmzj..."</span><span class="p">,</span>
        <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"public-key"</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">"challenge"</span><span class="o">:</span> <span class="s2">"kYhXBWX0HO5GstIS02yPJVhiZ0jZLH7PpC4tzJI-ZcA="</span><span class="p">,</span>
    <span class="s2">"rpId"</span><span class="o">:</span> <span class="s2">"demo.yubico.com"</span><span class="p">,</span>
    <span class="s2">"timeout"</span><span class="o">:</span> <span class="mi">30000</span><span class="p">,</span>
    <span class="s2">"userVerification"</span><span class="o">:</span> <span class="s2">"discouraged"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div>
<div class="paragraph"><p><strong>allowCredentials:</strong> list of public key credentials acceptable to the RP. Credentials can be omitted in username-less authentication scenario. An entry includes the type of the credential and credential id, and optionally a list of <strong>transports</strong> the client can use to find the credential.</p></div>
<div class="paragraph"><p><strong>challenge:</strong> contains a random value generated by the RP from the authenticator to sign as part of the authentication assertion.</p></div>
<div class="paragraph"><p><strong>rpId:</strong> relying party identifier claimed by the caller. This must exactly match the rp.id specified during registration.</p></div>
<div class="paragraph"><p><strong>timeout:</strong> the time, in milliseconds, that the caller is willing to wait for the call to complete.</p></div>
<div class="paragraph"><p><strong>userVerification:</strong> The default value is “preferred”. If “required”, the client will only use an authenticator capable of user verification. If "preferred", the client will use an authenticator capable of user verification if possible. If "discouraged", the authenticator is not asked to perform user verification but may do so at its discretion.</p></div>
<div class="paragraph"><p><strong>2.</strong> The JavaScript client calls <code>navigator.credentials.get()</code>. The browser validates the <code>rp.id</code> against the origin, hashes the <code>clientData</code>, and calls <code>authenticatorGetAssertion</code> method.</p></div>
<div class="paragraph"><p><strong>3.</strong> The authenticator finds a credential that matches the Relying Party ID and prompts the user to consent to the authentication. Assuming the steps are successful, the authenticator creates a new assertion by signing over the clientDataHash and authenticatorData with the private key generated for this account during registration.</p></div>
<div class="paragraph"><p><strong>4.</strong> The authenticator returns the authenticatorData and assertion signature back to the browser.</p></div>
<div class="paragraph"><p><strong>5.</strong> The browser resolves the Promise to a PublicKeyCredential that contains the AuthenticatorAssertionResponse which is returned to the RP to finalize the authentication</p></div>
</div>
<div class="sect3">
<h4 id="_example_2">Example</h4>
<div class="paragraph"><p><strong>Parsed PublicKeyCredential</strong></p></div>
<div class="paragraph"><p><em>Note: In the WebAuthn API, the binary values <code>authenticatorData</code>, <code>clientDataJSON</code> and <code>signature</code> are actually of type <code>ArrayBuffer</code> and not Base64 strings. This example displays them as Base64 strings for readability</em></p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"X9FrwMfmzj..."</span><span class="p">,</span>
  <span class="s2">"response"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"authenticatorData"</span><span class="o">:</span> <span class="s2">"xGzvgq0bVGR3WR0Aiwh1nsPm0uy085R0v-ppaZJdA7cBAAAACA"</span><span class="p">,</span>
    <span class="s2">"clientDataJSON"</span><span class="o">:</span> <span class="s2">"eyJjaGFsbG..."</span><span class="p">,</span>
    <span class="s2">"signature"</span><span class="o">:</span> <span class="s2">"MEUCIQDNrG..."</span>
  <span class="p">},</span>
  <span class="s2">"clientExtensionResults"</span><span class="o">:</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div></div></div>
<div class="paragraph"><p><strong>id:</strong> The credential identifier.</p></div>
<div class="paragraph"><p><strong>response:</strong> contains the metadata the RP needs to validate the assertion. The <strong>authenticatorData</strong> contains the authenticator data. The <strong>clientDataJSON</strong> contains the JSON-serialized data passed to the authenticator by the client in order to generate the credential. The signature contains the raw signature returned from the authenticator.</p></div>
<div class="paragraph"><p><strong>clientExtensionResults():</strong> method returns values for zero or more WebAuthn extensions.</p></div>
</div>
<div class="sect3">
<h4 id="_example_3">Example</h4>
<div class="paragraph"><p><strong>Parsed authenticatorData</strong></p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">"authData"</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">"flags"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"AT"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">"ED"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">"UP"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"UV"</span><span class="o">:</span> <span class="kc">false</span>
      <span class="p">},</span>
      <span class="s2">"rpIdHash"</span><span class="o">:</span> <span class="s2">"xGzvgq0bVGR3WR0Aiwh1nsPm0uy085R0v-ppaZJdA7c="</span><span class="p">,</span>
      <span class="s2">"signatureCounter"</span><span class="o">:</span> <span class="mi">8</span>
<span class="p">}</span>
</pre></div></div></div>
<div class="paragraph"><p><strong>authData:</strong> The authenticator data is a byte array containing data about the get credential operation, including a signature counter and a hash of the RP ID.</p></div>
<div class="paragraph"><p><strong>flags:</strong> The <strong>AT</strong> indicates whether the authenticator added attested credential data, and is always 0 in assertions. The <strong>ED</strong> flag indicates if the authenticator data has extensions. The <strong>UP</strong> flag indicates if the user is present. The <strong>UV</strong> flag indicates if the user is verified (PIN or Biometric).</p></div>
<div class="paragraph"><p><strong>rpIdHash:</strong> a SHA-256 hash of the RP ID the credential is scoped to.</p></div>
<div class="paragraph"><p><strong>signatureCounter:</strong> is incremented for each successful authenticatorGetAssertion operation. It is used by RPs to aid in detecting cloned authenticators.</p></div>
</div>
<div class="sect3">
<h4 id="_example_4">Example</h4>
<div class="paragraph"><p><strong>Parsed clientDataJSON</strong></p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"challenge"</span><span class="o">:</span> <span class="s2">"kYhXBWX0HO5GstIS02yPJVhiZ0jZLH7PpC4tzJI-ZcA"</span><span class="p">,</span>
  <span class="s2">"origin"</span><span class="o">:</span> <span class="s2">"https://demo.yubico.com"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"webauthn.get"</span>
<span class="p">}</span>
</pre></div></div></div>
<div class="paragraph"><p>The <strong>clientDataJSON</strong> object contains the <strong>challenge</strong> sent by the RP, the <strong>origin</strong> of the domain observed by the client, and the <strong>type</strong> of operation performed.</p></div>
<div class="paragraph"><p><strong>6.</strong> Upon receiving the result of the authentication request the server performs the validation of the response by:</p></div>
<div class="ulist"><ul>
<li>
<p>
Verifying the authenticator’s signature using the public key that was stored during the registration request
</p>
</li>
<li>
<p>
Verifying that the challenge signed by the authenticator matches the challenge that was generated by the server
</p>
</li>
<li>
<p>
Verifying that the relying party ID is the expected value
</p>
</li>
</ul></div>
<div class="paragraph"><p>The full list of validation steps can be found in the <a href="https://www.w3.org/TR/webauthn/#verifying-assertion" rel="noopener noreferrer" target="_blank">WebAuthn specification</a>.</p></div>
<div class="paragraph"><p><a href="/FIDO2//FIDO2_WebAuthn_Developer_Guide/WebAuthn_Server_Overview.html">Next: WebAuthn Server Overview</a></p></div>
</div>
</div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>