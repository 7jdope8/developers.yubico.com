<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>Git signing</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li class="active"><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/PGP">PGP</a></li>
<li class="active">Git signing</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/PGP">PGP</a><ul class="">
<li><a href="/PGP/Importing_keys.html">Importing keys</a></li>
<li><a href="/PGP/Card_edit.html">Card edit</a></li>
<li><a href="/PGP/SSH_authentication">SSH authentication</a></li>
<li class="active"><a href="/PGP/Git_signing.html">Git signing</a>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/developers.yubico.com/issues/new?title=Suggested%20edit%20for%20PGP/Git_signing" rel="noopener noreferrer" target="_blank"><i class="fa fa-pencil-square-o fa-lg"></i> Suggest Edits</a></li>
</ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_commit_signing">Commit Signing</h1>
<div class="sectionbody">
<div class="paragraph"><p>The most common <abbr title="Version Control System">VCS</abbr> being used nowadays is <a href="https://git-scm.com/" rel="noopener noreferrer" target="_blank">Git</a>. From a security standpoint, by default, Git doesnâ€™t provide any assurance. Although every Git "blob" is hashed using SHA-1, this is only useful as an integrity check, i.e., to guarantee that the files and the commits that you are working with, are the exact same things they were when they were first created.</p></div>
<div class="paragraph"><p>A less used feature of Git is its ability to sign your work. This allows users to verify that data is coming from a trusted source.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_setup">Setup</h2>
<div class="sectionbody">
<div class="paragraph"><p>The default program used to sign objects with Git is GPG. This means that Git is not aware (nor does it care) where the signing keys reside. Specifically, if you have imported a signature key onto your YubiKey, you will be able to sign commits and tags with it.</p></div>
<div class="paragraph"><p>The first thing you have to do is to instruct Git about how to use your key. If you have only one set of keys, GPG will probably pick the correct one for you. If you have multiple signature keys, and as a good practice in general, is better to explicitly specify which GPG key you want to use. This can be achieved with</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git config --global user.signingkey AABBCCDD
</pre>
</div></div>
<div class="paragraph"><p>Where <code>AABBCCDD</code> is your GPG key ID. By removing the <code>--global</code> switch it is possible make this setting repository-specific.</p></div>
<div class="sect2">
<h3 id="_signing_tags">Signing Tags</h3>
<div class="paragraph"><p>Tags are one of the things that can be signed with Git. To do so you can use the <code>-s</code> switch</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git tag foo-1.0 -s -m 'Release 1.0 of Foo'
</pre>
</div></div>
<div class="paragraph"><p>After issuing the command, you will be prompted for your GPG User PIN and a signed tag will be created. You can check the result of this operation by running the following command</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git show foo-1.0

tag foo-1.0
Tagger: Committer Name &lt;committer@yubico.com&gt;
Date:   Sat Feb 22 10:30:00 2014 +0200

Release 1.0 of Foo
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAABCAAGBQJW/OhLAAoJEJDLBFvTmUcBKXAH/0i3O/F+YjD8xMknsMZGSa2/
/uGNnF5SUCxQjztWCJecHmp88GdyagT9rcgv/q6eniElwp3M3dQXBTdJ+tPH+m7G
yZdrmuLqrn/NTzZKj3E5xMT9IXJ+jg4RsfhALGqnrG5XFtsB5VVucURbEsrqNM+Y
k5PJPQD4jroT/jOOWBysQMlJRNVZGYhtCC2DkRPQo8lII8/KW5mGu/GJzpQepW4K
vnqd6h9vwhTddzQ+EosNGscQvQBM4+CtLznK3iCYEnDe111wCtMm/ukxd7378/tj
O+mdC0Q+mxTOgIHcgZKBFzVosxiSHVXo7cvmGgk8kuONdaGo2D0k0PqceZPOjRw=
=4ZAu
-----END PGP SIGNATURE-----
</pre>
</div></div>
<div class="paragraph"><p>A similar output can also be achieved with the command</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git cat-file -p foo-1.0
</pre>
</div></div>
<div class="paragraph"><p>or with the command</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git verify-tag foo-1.0
</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_verifying_tags">Verifying Tags</h3>
<div class="paragraph"><p>Once a tag has been signed, it is possible to ask Git to verify a signature for us. This is done by using the <code>-v</code> switch on the tag we want to verify</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git tag -v foo-1.0

object 3fe8b3b4b9394678aeadfa4113e8982802f759f8
type commit
tag foo-1.0
tagger Committer Name &lt;committer@yubico.com&gt; 1393230600 +0200

Release 1.0 of Foo
gpg: Signature made Sat Feb 22 10:30:00 2014 CEST using RSA key ID AABBCCDD
gpg: Good signature from "Committer Name &lt;committer@yubico.com&gt;"
</pre>
</div></div>
<div class="paragraph"><p>Keep in mind that, behind the scenes, this is invoking GPG which, in order to verify the signature for you, should be informed of who is the owner of key ID <code>AABBCCDD</code> by importing their public key. If this information is missing, you will receive an error message.</p></div>
</div>
<div class="sect2">
<h3 id="_signing_commits">Signing Commits</h3>
<div class="paragraph"><p>The other kind of object that you can sign with Git are commits. The procedure is very similar to what you have to do for tags. The command needed is the following</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git commit -S -m 'Fixed a small undocumented feature that made foo crash'
</pre>
</div></div>
<div class="paragraph"><p>Just like before you will be prompted for your User PIN and the signed commit will be created. Note that the command shown above uses the capital letter <code>S</code> (the extended form would be <code>--gpg-sign</code>). Using the lowercase letter <code>s</code>  will only include the text <em>Signed-off-by: Committer Name &lt;<a href="mailto:committer@yubico.com">committer@yubico.com</a>&gt;</em> in your commit message and <strong>not</strong> actually sign the commit.</p></div>
<div class="paragraph"><p>To display the signature of the last commit you can use</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git cat-file -p HEAD
tree c09dec94a1b2f8c4792fd0faef35623e0463fc73
parent 3fe8b3b4b9394678aeadfa4113e8982802f759f8
author Committer Name &lt;committer@yubico.com&gt; 1393232400 +0200
gpgsig -----BEGIN PGP SIGNATURE-----
 Version: GnuPG v1

iQEcBAABCAAGBQJW/PEoAAoJEJDLBFvTmUcBo58H/1hb+uhqVCRRFnQDJ7gHM+v1
6vgWxtaEpf86foJe+V/8r2dij2fKAPcbMQbeakfO0PplSRUY6+XnvXY+2uFHs2TB
BxsAz1HYLnl6jXRKpLqduqJLmnwnkwaMCr1Bx/rZ1CWAsKtwBf4AGpW7ws9Dv6zh
Y7EPcVeO4dvftTqCsoOu6ZBmw9U24DA5XCl7ZG2nDiW9spS8CTlznGA3/LJ56mWF
Rm+xaJbfFwr2KS5wdyZkzdEh0sIcbmAYVhnKkj4HiBegrK+wCcayOfc0YMzOUPL9
uJ4pB32g0jLJbpNHRXqhQ/OU9eCRG3B55UBpimvLOLok3si6d/fYd3zTmB9bJaE=
=Bh19
-----END PGP SIGNATURE-----
</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_verifying_commits">Verifying Commits</h3>
<div class="paragraph"><p>Signed commits can be verified in many different places. One way is to manually display the commit</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git show HEAD --show-signature

commit 552b36ec86790bfdac679ab23e6d61133ff0b383
gpg: Signature made Sat 22 Feb 2014 11:00:00 CEST using RSA key ID AABBCCDD
gpg: Good signature from "Committer Name &lt;committer@yubico.com&gt;"
Author: Committer Name &lt;committer@yubico.com&gt;
Date:   Sat Feb 22 11:00:00 2014 +0200

    Fixed a small undocumented feature that made foo crash
</pre>
</div></div>
<div class="paragraph"><p>As before, GPG has to have the public key of the signer to successuflly verify the signature.</p></div>
<div class="paragraph"><p>The previous command assumes that the commit of interest was the very last one. To verify a generic commit replace <code>HEAD</code> with the commit ID (<code>552b36ec86790bfdac679ab23e6d61133ff0b383</code> in this case).</p></div>
<div class="paragraph"><p>Alternative commands to verify commit signatures are</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git log --show-signature # Displays all commits and verify signed ones

<span class="sh-dollar"></span>git verify-commit HEAD # Displays and verify the latest commit
</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_merging_and_pushing">Merging and Pushing</h3>
<div class="paragraph"><p>When merging branches or tags, it is possible to ask Git to verify the signature of the commits being merged. This is done with</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git merge --verify-signatures other_branch
</pre>
</div></div>
<div class="paragraph"><p>If the signatures can not be verified, the merge will be aborted.</p></div>
<div class="paragraph"><p>Similarly, the <code>-S</code> switch can be used to sign the commit resulting from a merge.</p></div>
<div class="paragraph"><p>Also, if you created <em>annotated</em> tags, when you merge them Git will create a new commit for you. During this process it will also verify the invovled signatures and include the verification output in the comment of the commit message.</p></div>
<div class="paragraph"><p>Since Git version 2.2.0 it is also possible to sign git <em>pushes</em> by doing <code>git push --signed</code>. This is used to prove the intention the author had of pushing a specific set of commits and have them become the new tip of some branch.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_git_variables">Git Variables</h2>
<div class="sectionbody">
<div class="paragraph"><p>There are a few Git variables that are useful and related to signing. Here is a short list taken from <code>git config --help</code>. More details can be found there.</p></div>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
commit.gpgSign
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
    Allows to always sign commit. Useful for when a large number of commits must be signed;
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
gpg.program
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
    Specify which program to use for signatures and verification. Its command line must be GPG-compliant. Useful for choosing specific GPG version (e.g., gpg2 vs gpg) or a using a custom program;
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
receive.certNonceSeed
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
    Tells Git to verify a signed push using a nonce.
</p>
</td>
</tr>
</table></div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>