<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>Overview</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li class="active"><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/U2F">U2F</a></li>
<li><a href="/U2F/Protocol_details">Protocol details</a></li>
<li class="active">Overview</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/U2F">U2F</a><ul class="">
<li><a href="/U2F/Plugins.html">Plugins</a></li>
<li><a href="/U2F/Libraries">Libraries</a></li>
<li><a href="/U2F/Standalone_servers">Standalone servers</a></li>
<li><a href="/U2F/Attestation_and_Metadata">Attestation and Metadata</a></li>
<li class="active"><a href="/U2F/Protocol_details">Protocol details</a><ul class="">
<li class="active"><a href="/U2F/Protocol_details/Overview.html">Overview</a>
<li><a href="/U2F/Protocol_details/Key_generation.html">Key generation</a></li>
<li><a href="/U2F/Protocol_details/Specification.html">Specification</a></li>
</li></ul>
<li><a href="/U2F/App_ID.html">App ID</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/developers.yubico.com/issues/new?title=Suggested%20edit%20for%20U2F/Protocol_details/Overview" rel="noopener noreferrer" target="_blank"><i class="fa fa-pencil-square-o fa-lg"></i> Suggest Edits</a></li>
</ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_u2f_technical_overview">U2F Technical Overview</h1>
<div class="sectionbody">
<div class="paragraph"><p>U2F is a challenge-response protocol extended with <em>phishing and <abbr title="Man-in-the-Middle">MitM</abbr> protection</em>, <em>application-specific keys</em>, <em>device cloning detection</em> and <em>device attestation</em>. There are two flows: <em>registration</em> and <em>authentication</em>.</p></div>
<div class="sect2">
<h3 id="_1_challenge_response">1. Challenge-response</h3>
<div class="paragraph"><p>We start out with a simple <a href="http://en.wikipedia.org/wiki/Challenge%E2%80%93response_authentication" rel="noopener noreferrer" target="_blank">challenge-response</a> authentication flow, based on <a href="http://en.wikipedia.org/wiki/Public-key_cryptography" rel="noopener noreferrer" target="_blank">public-key cryptography</a>.
The U2F device has a private key <em>k<sub>priv</sub></em> and the <abbr title="Relying Party">RP</abbr> is given the corresponding public key <em>k<sub>pub</sub></em>.
The key pair is generated in the device’s
<a href="http://en.wikipedia.org/wiki/Tamper_resistance#Chips" rel="noopener noreferrer" target="_blank">tamper-resistant</a>
execution environment, from where <em>k<sub>priv</sub></em> cannot leave.</p></div>
<div class="paragraph"><p><span class="image">
<img alt="auth_flow1.svg" src="auth_flow1.svg">
</img></span></p></div>
</div>
<div class="sect2">
<h3 id="_2_phishing_and_mitm_protection">2. Phishing and MitM protection</h3>
<div class="paragraph"><p>The concept is that the client compiles what it knows about the current HTTP connection (URI and TLS Channel ID).
This information is then signed by the U2F device and sent to the RP, which verifies that the information is correct.</p></div>
<div class="paragraph"><p>Additions to the authentication flow:</p></div>
<div class="ulist"><ul>
<li>
<p>
Origin (URI) — prevents phishing.
</p>
</li>
<li>
<p>
<a href="http://en.wikipedia.org/wiki/Transport_Layer_Security_Channel_ID" rel="noopener noreferrer" target="_blank">TLS Channel ID</a> (optional) — prevents MitM.
</p>
</li>
</ul></div>
<div class="paragraph"><p><span class="image">
<img alt="auth_flow2.svg" src="auth_flow2.svg">
</img></span></p></div>
</div>
<div class="sect2">
<h3 id="_3_application_specific_keys">3. Application-specific keys</h3>
<div class="paragraph"><p>Application-specific keys prevents relying parties from tracking devices between different user accounts.
This means that Example.com cannot know whether <em>User1</em> and <em>User2</em> shares the same device.</p></div>
<div class="paragraph"><p>The U2F device generates a new key pair and key handle for each registration.
The handle is stored by the RP and sent back to the device upon authentication. This way, the device knows which key to authenticate with (e.g. <em>User1</em>'s key or <em>User2</em>'s key).</p></div>
<div class="paragraph"><p>Additions to the authentication flow:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="/U2F/Protocol_details/Key_generation.html">Key generation</a> on the device
</p>
</li>
<li>
<p>
Key handle, stored by the server together with <em>k<sub>pub</sub></em>.
</p>
</li>
<li>
<p>
<a href="/U2F/App_ID.html">App ID</a>, used for scoping a key handle.
</p>
</li>
</ul></div>
<div class="paragraph"><p><span class="image">
<img alt="auth_flow3.svg" src="auth_flow3.svg">
</img></span></p></div>
</div>
<div class="sect2">
<h3 id="_4_device_cloning_detection">4. Device cloning detection</h3>
<div class="paragraph"><p>As already mentioned, Yubico’s U2F devices are tamper-resistant and <em>k<sub>priv</sub></em> cannot be read externally (at the very least not undetected). However, to provide cloning detection to U2F devices without tamper-resistant secure elements (e.g software implementations) we add an authentication counter.
The concept is simple: The device increments the counter when authenticating, and the RP verifies that the counter is higher than last time.</p></div>
<div class="paragraph"><p>Additions to the authentication flow:</p></div>
<div class="ulist"><ul>
<li>
<p>
A counter, sent from the device to the RP.
</p>
</li>
</ul></div>
<div class="paragraph"><p><span class="image">
<img alt="auth_flow4.svg" src="auth_flow4.svg">
</img></span></p></div>
</div>
<div class="sect2">
<h3 id="_5_device_attestation">5. Device attestation</h3>
<div class="paragraph"><p>Attestation gives relying parties <em>the possibility</em> to verify token properties, such as token model.
It is implemented via an attestation certificate, signed by the device vendor, that the device sends to the RP upon registration.
Attestation does not affect the authentication flow.</p></div>
<div class="paragraph"><p>Additions to the registration flow:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="/U2F/Attestation_and_Metadata/">Attestation certificate</a>
</p>
</li>
</ul></div>
<div class="paragraph"><p><span class="image">
<img alt="reg_flow.svg" src="reg_flow.svg">
</img></span></p></div>
</div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>