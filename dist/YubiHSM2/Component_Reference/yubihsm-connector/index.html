<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>yubihsm-connector</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li class="active"><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/YubiHSM2">YubiHSM2</a></li>
<li><a href="/YubiHSM2/Component_Reference">Component Reference</a></li>
<li class="active">yubihsm-connector</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/YubiHSM2">YubiHSM2</a><ul class="">
<li><a href="/YubiHSM2/Releases">Releases</a></li>
<li><a href="/YubiHSM2/Product_Overview">Product Overview</a></li>
<li><a href="/YubiHSM2/Concepts">Concepts</a></li>
<li><a href="/YubiHSM2/Commands">Commands</a></li>
<li class="active"><a href="/YubiHSM2/Component_Reference">Component Reference</a><ul class="">
<li class="active"><a href="/YubiHSM2/Component_Reference/yubihsm-connector">yubihsm-connector</a>
<li><a href="/YubiHSM2/Component_Reference/yubihsm-shell">yubihsm-shell</a></li>
<li><a href="/YubiHSM2/Component_Reference/yubihsm-setup">yubihsm-setup</a></li>
<li><a href="/YubiHSM2/Component_Reference/libyubihsm">libyubihsm</a></li>
<li><a href="/YubiHSM2/Component_Reference/python-yubihsm">python-yubihsm</a></li>
<li><a href="/YubiHSM2/Component_Reference/yubihsm-wrap">yubihsm-wrap</a></li>
<li><a href="/YubiHSM2/Component_Reference/KSP">KSP</a></li>
<li><a href="/YubiHSM2/Component_Reference/PKCS_11">PKCS 11</a></li>
</li></ul>
<li><a href="/YubiHSM2/Usage_Guides">Usage Guides</a></li>
<li><a href="/YubiHSM2/Backup_and_Restore">Backup and Restore</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul></ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_connector">Connector</h1>
<div class="sectionbody">
<div class="paragraph"><p>The Connector, <a href="/yubihsm-connector/">yubihsm-connector</a>, performs the communication between
the YubiHSM 2 and applications that use it.</p></div>
<div class="paragraph"><p>The Connector must have permissions to access the USB device, and different
operating systems behave differently in this regard.
The easiest way to get started is to run the Connector with Administrator privileges
(e.g. with <code>sudo</code>), but the safest way to run the Connector is to use your
operating systemâ€™s configuration to only give it the privileges necessary to
access the YubiHSM 2 USB device.</p></div>
<div class="paragraph"><p>The Connector is not a trusted component. Sessions are established
cryptographically between the application and the YubiHSM 2 using a
symmetric mutual authentication scheme that is both encrypted and
authenticated.</p></div>
<div class="paragraph"><p>The Connector is not required to run on the same host as the
applications which access it. In that case the Connector should be
configured to be listening on a different address and port rather than
the default <code>localhost:12345</code>, making sure that the client has access.</p></div>
<div class="paragraph"><p>The protocol is tunneled over HTTP, but it is <strong>not</strong> a RESTful API or similar.
It is however possible to get information regarding the Connector by issuing a
GET request on the <code>/connector/status</code> URI.</p></div>
<div class="sect2">
<h3 id="_https_connections">HTTPS Connections</h3>
<div class="paragraph"><p>As mentioned earlier, the Connector is not meant to be a trusted
component. For this reason it defaults to HTTP connections. It is
possible to use HTTPS, however this requires providing a key and a
certificate to the Connector.</p></div>
<div class="paragraph"><p>Another option is to use a reverse proxy such as nginx before the
Connector and have that handle TLS.</p></div>
</div>
<div class="sect2">
<h3 id="_configuration">Configuration</h3>
<div class="paragraph"><p>Sample configuration for the Connector; <code>yubihsm-connector-config.yaml</code></p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="c1"># Certificate (X.509)</span>
<span class="l l-Scalar l-Scalar-Plain">cert</span><span class="p p-Indicator">:</span> <span class="s">""</span>

<span class="c1"># Certificate key</span>
<span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="s">""</span>

<span class="c1"># Listening address. Defaults to "localhost:12345".</span>
<span class="l l-Scalar l-Scalar-Plain">listen</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost:12345</span>

<span class="c1"># Device serial in case of multiple devices</span>
<span class="l l-Scalar l-Scalar-Plain">serial</span><span class="p p-Indicator">:</span> <span class="s">""</span>

<span class="c1"># Log to syslog/eventlog. Defaults to "false".</span>
<span class="l l-Scalar l-Scalar-Plain">syslog</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="c1"># Use to enable host header filtering. Default to "false".</span>
<span class="c1"># Use this if there is an absolute need to use a web browser on the host where the YubiHSM 2 is installed to connect to untrusted web sites on the Internet.</span>
<span class="l l-Scalar l-Scalar-Plain">enable-host-whitelist</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="c1"># Default list for the host header filter</span>
<span class="l l-Scalar l-Scalar-Plain">host-whitelist</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost,localhost.,127.0.0.1,[::1]</span>
</pre></div></div></div>
<div class="paragraph"><p>Sample udev rule to be placed into <code>/etc/udev/rules.d/</code>:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="c1"># This udev file should be used with udev 188 and newer</span>
<span class="na">ACTION!</span><span class="o">=</span><span class="s">"add|change", GOTO="yubihsm2_connector_end"</span>

<span class="c1"># Yubico YubiHSM2</span>
<span class="c1"># The OWNER attribute here has to match the uid of the process running the Connector</span>
<span class="na">SUBSYSTEM</span><span class="o">=</span><span class="s">="usb", ATTRS{idVendor}=="1050", ATTRS{idProduct}=="0030", OWNER="yubihsm-connector"</span>

<span class="na">LABEL</span><span class="o">=</span><span class="s">"yubihsm2_connector_end"</span>
</pre></div></div></div>
</div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>