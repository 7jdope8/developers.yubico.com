<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>Get Log Entries</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li class="active"><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/YubiHSM2">YubiHSM2</a></li>
<li><a href="/YubiHSM2/Commands">Commands</a></li>
<li class="active">Get Log Entries</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/YubiHSM2">YubiHSM2</a><ul class="">
<li><a href="/YubiHSM2/Releases">Releases</a></li>
<li><a href="/YubiHSM2/Product_Overview">Product Overview</a></li>
<li><a href="/YubiHSM2/Concepts">Concepts</a></li>
<li class="active"><a href="/YubiHSM2/Commands">Commands</a><ul class="">
<li><a href="/YubiHSM2/Commands/Authenticate_Session.html">Authenticate Session</a></li>
<li><a href="/YubiHSM2/Commands/Blink_Device.html">Blink Device</a></li>
<li><a href="/YubiHSM2/Commands/Change_Authentication_Key.html">Change Authentication Key</a></li>
<li><a href="/YubiHSM2/Commands/Close_Session.html">Close Session</a></li>
<li><a href="/YubiHSM2/Commands/Create_Otp_Aead.html">Create Otp Aead</a></li>
<li><a href="/YubiHSM2/Commands/Create_Session.html">Create Session</a></li>
<li><a href="/YubiHSM2/Commands/Decrypt_Oaep.html">Decrypt Oaep</a></li>
<li><a href="/YubiHSM2/Commands/Decrypt_Otp.html">Decrypt Otp</a></li>
<li><a href="/YubiHSM2/Commands/Decrypt_Pkcs1.html">Decrypt Pkcs1</a></li>
<li><a href="/YubiHSM2/Commands/Delete_Object.html">Delete Object</a></li>
<li><a href="/YubiHSM2/Commands/Derive_Ecdh.html">Derive Ecdh</a></li>
<li><a href="/YubiHSM2/Commands/Device_Info.html">Device Info</a></li>
<li><a href="/YubiHSM2/Commands/Echo.html">Echo</a></li>
<li><a href="/YubiHSM2/Commands/Export_Wrapped.html">Export Wrapped</a></li>
<li><a href="/YubiHSM2/Commands/Generate_Asymmetric_Key.html">Generate Asymmetric Key</a></li>
<li><a href="/YubiHSM2/Commands/Generate_Hmac_Key.html">Generate Hmac Key</a></li>
<li><a href="/YubiHSM2/Commands/Generate_Otp_Aead_Key.html">Generate Otp Aead Key</a></li>
<li><a href="/YubiHSM2/Commands/Generate_Wrap_Key.html">Generate Wrap Key</a></li>
<li class="active"><a href="/YubiHSM2/Commands/Get_Log_Entries.html">Get Log Entries</a>
<li><a href="/YubiHSM2/Commands/Get_Object_Info.html">Get Object Info</a></li>
<li><a href="/YubiHSM2/Commands/Get_Opaque.html">Get Opaque</a></li>
<li><a href="/YubiHSM2/Commands/Get_Option.html">Get Option</a></li>
<li><a href="/YubiHSM2/Commands/Get_Pseudo_Random.html">Get Pseudo Random</a></li>
<li><a href="/YubiHSM2/Commands/Get_Public_Key.html">Get Public Key</a></li>
<li><a href="/YubiHSM2/Commands/Get_Storage_Info.html">Get Storage Info</a></li>
<li><a href="/YubiHSM2/Commands/Get_Template.html">Get Template</a></li>
<li><a href="/YubiHSM2/Commands/Import_Wrapped.html">Import Wrapped</a></li>
<li><a href="/YubiHSM2/Commands/List_Objects.html">List Objects</a></li>
<li><a href="/YubiHSM2/Commands/Put_Asymmetric_Key.html">Put Asymmetric Key</a></li>
<li><a href="/YubiHSM2/Commands/Put_Authentication_Key.html">Put Authentication Key</a></li>
<li><a href="/YubiHSM2/Commands/Put_Hmac_Key.html">Put Hmac Key</a></li>
<li><a href="/YubiHSM2/Commands/Put_Opaque.html">Put Opaque</a></li>
<li><a href="/YubiHSM2/Commands/Put_Otp_Aead_Key.html">Put Otp Aead Key</a></li>
<li><a href="/YubiHSM2/Commands/Put_Template.html">Put Template</a></li>
<li><a href="/YubiHSM2/Commands/Put_Wrap_Key.html">Put Wrap Key</a></li>
<li><a href="/YubiHSM2/Commands/Randomize_Otp_Aead.html">Randomize Otp Aead</a></li>
<li><a href="/YubiHSM2/Commands/Reset_Device.html">Reset Device</a></li>
<li><a href="/YubiHSM2/Commands/Rewrap_Otp_Aead.html">Rewrap Otp Aead</a></li>
<li><a href="/YubiHSM2/Commands/Session_Message.html">Session Message</a></li>
<li><a href="/YubiHSM2/Commands/Set_Log_Index.html">Set Log Index</a></li>
<li><a href="/YubiHSM2/Commands/Set_Option.html">Set Option</a></li>
<li><a href="/YubiHSM2/Commands/Sign_Attestation_Certificate.html">Sign Attestation Certificate</a></li>
<li><a href="/YubiHSM2/Commands/Sign_Ecdsa.html">Sign Ecdsa</a></li>
<li><a href="/YubiHSM2/Commands/Sign_Eddsa.html">Sign Eddsa</a></li>
<li><a href="/YubiHSM2/Commands/Sign_Hmac.html">Sign Hmac</a></li>
<li><a href="/YubiHSM2/Commands/Sign_Pkcs1.html">Sign Pkcs1</a></li>
<li><a href="/YubiHSM2/Commands/Sign_Pss.html">Sign Pss</a></li>
<li><a href="/YubiHSM2/Commands/Sign_Ssh_Certificate.html">Sign Ssh Certificate</a></li>
<li><a href="/YubiHSM2/Commands/Unwrap_Data.html">Unwrap Data</a></li>
<li><a href="/YubiHSM2/Commands/Verify_Hmac.html">Verify Hmac</a></li>
<li><a href="/YubiHSM2/Commands/Wrap_Data.html">Wrap Data</a></li>
</li></ul>
<li><a href="/YubiHSM2/Component_Reference">Component Reference</a></li>
<li><a href="/YubiHSM2/Usage_Guides">Usage Guides</a></li>
<li><a href="/YubiHSM2/Backup_and_Restore">Backup and Restore</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul></ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_get_log_entries">GET LOG ENTRIES</h1>
<div class="sectionbody">
<div class="paragraph"><p>Fetch device audit log.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph"><p>Fetch all current entries from the device Log Store.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_shell_example">Shell Example</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content monospaced">
<pre>yubihsm&gt; audit get 0
0 unlogged boots found
0 unlogged authentications found
Found 6 items
item:    46 -- cmd: 0x4b -- length:  234 -- session key: 0x0001 -- target key: 0xcf94 -- second key: 0x997e -- result: 0xcb -- tick: 335725 -- hash: 415f51f1f035a1b713e730e4464e4033
item:    47 -- cmd: 0x4c -- length:   77 -- session key: 0x0001 -- target key: 0xaff7 -- second key: 0xffff -- result: 0xcc -- tick: 351714 -- hash: 5496a60d478c2b9c801d8d32ca66b554
item:    48 -- cmd: 0x00 -- length:    0 -- session key: 0xffff -- target key: 0x0000 -- second key: 0x0000 -- result: 0x00 -- tick: 0 -- hash: 14ac7747ba9bbb243cfc70befeb5349b
item:    49 -- cmd: 0x03 -- length:   10 -- session key: 0xffff -- target key: 0x0001 -- second key: 0xffff -- result: 0x83 -- tick: 139 -- hash: b20a8f25c025e693a8e869b433294a20
item:    50 -- cmd: 0x04 -- length:   17 -- session key: 0xffff -- target key: 0x0001 -- second key: 0xffff -- result: 0x84 -- tick: 139 -- hash: ebfae425c319ac7a0afbb8b92597de7c
item:    51 -- cmd: 0x67 -- length:    2 -- session key: 0x0001 -- target key: 0xffff -- second key: 0xffff -- result: 0xe7 -- tick: 697 -- hash: 2e395d1b706668737e1d2215813db47e</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_protocol_details">Protocol Details</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_command">Command</h3>
<table class="table table-bordered table-striped tableblock frame-all grid-all" style="
width:100%;
">
<col style="width:100%;">
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">T<sub>c</sub> = 0x4d</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">L<sub>c</sub> = 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">V<sub>c</sub> = Ø</p></td>
</tr>
</tbody>
</col></table>
</div>
<div class="sect2">
<h3 id="_response">Response</h3>
<table class="table table-bordered table-striped tableblock frame-all grid-all" style="
width:100%;
">
<col style="width:100%;">
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">T<sub>r</sub> = 0xcd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">L<sub>r</sub> = 2 + 2 + 1 + (N * 32)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">V<sub>r</sub> = B || O || N || E<sub>1</sub> || E<sub>2</sub> || … || E<sub>N</sub></p></td>
</tr>
</tbody>
</col></table>
<div class="paragraph"><p>B := Number of unlogged boot events (if the log buffer is full and audit enforce
is set) (2 bytes)</p></div>
<div class="paragraph"><p>O := Number of unlogged authentication events (if the log buffer is full and
audit enforce is set) (2 bytes)</p></div>
<div class="paragraph"><p>N := Number of elements in the list (1 byte)</p></div>
<div class="paragraph"><p>E<sub>i</sub> := Generic log entry composed of the command number (two bytes), command ID (one byte),
command length (two bytes), the Session originating the command (two bytes), the target key affected
by the command (two bytes), a secondary key if the command affected more than one key (two bytes),
the result of the command (one byte), the systick when the command was processed (4 bytes) and a digest (16 bytes). If the
command was unsuccessful, the result byte will instead contain the error code.</p></div>
<div class="paragraph"><p>The digest is computed as trunc(16, SHA256(E<sub>i</sub> || trunc(16, SHA256(E<sub>i-1</sub>)))).
For the initial log entry, a random string of 32 bytes is used, instead of the
digest of the previous message.</p></div>
<div class="paragraph"><p>When the device initializes after a reset, a log entry with all fields set to
<code>0xff</code> is logged.</p></div>
<div class="paragraph"><p>When the device boots up, a log entry with all fields set to <code>0x00</code> is logged.</p></div>
</div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>