<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>java-webauthn-server</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li class="active">java-webauthn-server</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/java-webauthn-server">java-webauthn-server</a><ul class="">
<li><a href="/java-webauthn-server/Release_Notes.html">Release Notes</a></li>
<li><a href="/java-webauthn-server/webauthn-server-demo">webauthn-server-demo</a></li>
</ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/java-webauthn-server" rel="noopener noreferrer" target="_blank"><i class="fa fa-github fa-lg"></i> Github</a></li>
</ul>
</div>
<div id="page-content"><h1>java-webauthn-server</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p><span class="image">
<a class="image" href="https://travis-ci.org/Yubico/java-webauthn-server">
<img alt="Build Status" src="https://travis-ci.org/Yubico/java-webauthn-server.svg?branch=master">
</img></a>
</span>
<span class="image">
<a class="image" href="https://coveralls.io/github/Yubico/java-webauthn-server">
<img alt="Coverage Status" src="https://coveralls.io/repos/github/Yubico/java-webauthn-server/badge.svg">
</img></a>
</span></p></div>
<div class="paragraph"><p>Server-side <a href="https://www.w3.org/TR/webauthn/">Web Authentication</a> library for
Java. Provides implementations of the
<a href="https://www.w3.org/TR/webauthn/#rp-operations">Relying Party operations</a> required
for a server to support Web Authentication. This includes registering
authenticators and authenticating registered authenticators.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_table_of_contents">Table of contents</h2>
<div class="sectionbody">
<div id="toc">
<div id="toctitle"></div>
<noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dependency_configuration">Dependency configuration</h2>
<div class="sectionbody">
<div class="paragraph"><p>Maven:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.yubico&lt;/groupId&gt;
  &lt;artifactId&gt;webauthn-server-core&lt;/artifactId&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
  &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div></div>
<div class="paragraph"><p>Gradle:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>compile 'com.yubico:webauthn-server-core:1.0.0'</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_features">Features</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Generates request objects suitable as parameters to
  <code>navigator.credentials.create()</code> and <code>.get()</code>
</p>
</li>
<li>
<p>
Performs all necessary
  <a href="https://www.w3.org/TR/webauthn/#rp-operations">validation logic</a> on the
  response from the client
</p>
</li>
<li>
<p>
Optionally integrates with a "metadata service" to verify
  <a href="https://www.w3.org/TR/webauthn/#sctn-attestation">authenticator attestations</a>
  and annotate responses with additional authenticator metadata
</p>
</li>
</ul></div>
<div class="sect2">
<h3 id="_non_features">Non-features</h3>
<div class="paragraph"><p>This library has no concept of accounts, sessions, permissions or identity
federation, and itâ€™s not an authentication framework; it only deals with
executing the WebAuthn authentication mechanism. Sessions, account management
and other higher level concepts can make use of this authentication mechanism,
but the authentication mechanism alone does not make a security system.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_known_issues">Known issues</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
In the <a href="webauthn-server-demo">example app</a>, authentication does not work in
  Chrome as of version 70. This is due to a
  <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=847878">bug in
  Chrome</a> which will not be worked around here. To work around this in
  application code, you can omit the
  <a href="https://yubico.github.io/java-webauthn-server/webauthn-server-core/com/yubico/webauthn/data/AuthenticatorAssertionResponse.AuthenticatorAssertionResponseBuilder.html#userHandle-java.util.Optional"><code>userHandle</code></a>
  when constructing an
  <a href="https://yubico.github.io/java-webauthn-server/webauthn-server-core/com/yubico/webauthn/data/AuthenticatorAssertionResponse.html"><code>AuthenticatorAssertionResponse</code></a>
  value if the <code>userHandle</code> is empty. See
  <a href="https://github.com/Yubico/java-webauthn-server/issues/12">https://github.com/Yubico/java-webauthn-server/issues/12</a> .
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_documentation">Documentation</h2>
<div class="sectionbody">
<div class="paragraph"><p>See the
<a href="https://yubico.github.io/java-webauthn-server/webauthn-server-core/com/yubico/webauthn/package-summary.html">Javadoc</a>
for in-depth API documentation.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_quick_start">Quick start</h2>
<div class="sectionbody">
<div class="paragraph"><p>Implement the
<a href="https://yubico.github.io/java-webauthn-server/webauthn-server-core/com/yubico/webauthn/CredentialRepository.html"><code>CredentialRepository</code></a>
interface with your database access logic. See
<a href="https://github.com/Yubico/java-webauthn-server/blob/master/webauthn-server-demo/src/main/java/demo/webauthn/InMemoryRegistrationStorage.java"><code>InMemoryRegistrationStorage</code></a>
for an example.</p></div>
<div class="paragraph"><p>Instantiate the
<a href="https://yubico.github.io/java-webauthn-server/webauthn-server-core/com/yubico/webauthn/RelyingParty.html"><code>RelyingParty</code></a>
class:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="n">RelyingPartyIdentity</span> <span class="n">rpIdentity</span> <span class="o">=</span> <span class="n">RelyingPartyIdentity</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="s">"example.com"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Example Application"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">RelyingParty</span> <span class="n">rp</span> <span class="o">=</span> <span class="n">RelyingParty</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">identity</span><span class="o">(</span><span class="n">rpIdentity</span><span class="o">)</span>
    <span class="o">.</span><span class="na">credentialRepository</span><span class="o">(</span><span class="k">new</span> <span class="n">MyCredentialRepository</span><span class="o">())</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div></div></div>
<div class="sect2">
<h3 id="_registration">Registration</h3>
<div class="paragraph"><p>Initiate a registration ceremony:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="kt">byte</span><span class="o">[]</span> <span class="n">userHandle</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">64</span><span class="o">];</span>
<span class="n">random</span><span class="o">.</span><span class="na">nextBytes</span><span class="o">(</span><span class="n">userHandle</span><span class="o">);</span>

<span class="n">PublicKeyCredentialCreationOptions</span> <span class="n">request</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="na">startRegistration</span><span class="o">(</span><span class="n">StartRegistrationOptions</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">user</span><span class="o">(</span><span class="n">UserIdentity</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"alice"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">displayName</span><span class="o">(</span><span class="s">"Alice Hypothetical"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="k">new</span> <span class="n">ByteArray</span><span class="o">(</span><span class="n">userHandle</span><span class="o">))</span>
        <span class="o">.</span><span class="na">build</span><span class="o">())</span>
    <span class="o">.</span><span class="na">build</span><span class="o">());</span>
</pre></div></div></div>
<div class="paragraph"><p>Serialize <code>request</code> to JSON and send it to the client:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>

<span class="n">ObjectMapper</span> <span class="n">jsonMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">()</span>
    <span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="n">SerializationFeature</span><span class="o">.</span><span class="na">FAIL_ON_EMPTY_BEANS</span><span class="o">,</span> <span class="kc">false</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setSerializationInclusion</span><span class="o">(</span><span class="n">Include</span><span class="o">.</span><span class="na">NON_ABSENT</span><span class="o">)</span>
    <span class="o">.</span><span class="na">registerModule</span><span class="o">(</span><span class="k">new</span> <span class="n">Jdk8Module</span><span class="o">());</span>

<span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">jsonMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
<span class="k">return</span> <span class="n">json</span><span class="o">;</span>
</pre></div></div></div>
<div class="paragraph"><p>Get the response from the client:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">responseJson</span> <span class="o">=</span> <span class="cm">/* ... */</span><span class="o">;</span>
<span class="n">PublicKeyCredential</span><span class="o">&lt;</span><span class="n">AuthenticatorAttestationResponse</span><span class="o">,</span> <span class="n">ClientRegistrationExtensionOutputs</span><span class="o">&gt;</span> <span class="n">pkc</span> <span class="o">=</span>
    <span class="n">jsonMapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">responseJson</span><span class="o">,</span> <span class="k">new</span> <span class="n">TypeReference</span><span class="o">&lt;</span><span class="n">PublicKeyCredential</span><span class="o">&lt;</span><span class="n">AuthenticatorAttestationResponse</span><span class="o">,</span> <span class="n">ClientRegistrationExtensionOutputs</span><span class="o">&gt;&gt;(){});</span>
</pre></div></div></div>
<div class="paragraph"><p>Validate the response:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="k">try</span> <span class="o">{</span>
    <span class="n">RegistrationResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="na">finishRegistration</span><span class="o">(</span><span class="n">FinishRegistrationOptions</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">request</span><span class="o">)</span>
        <span class="o">.</span><span class="na">response</span><span class="o">(</span><span class="n">pkc</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">());</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">RegistrationFailedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
</pre></div></div></div>
<div class="paragraph"><p>Update your database:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="n">storeCredential</span><span class="o">(</span><span class="s">"alice"</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getKeyId</span><span class="o">(),</span> <span class="n">result</span><span class="o">.</span><span class="na">getPublicKeyCose</span><span class="o">());</span>
</pre></div></div></div>
</div>
<div class="sect2">
<h3 id="_authentication">Authentication</h3>
<div class="paragraph"><p>Initiate an authentication ceremony:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="n">AssertionRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="na">startAssertion</span><span class="o">(</span><span class="n">StartAssertionOptions</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
    <span class="o">.</span><span class="na">username</span><span class="o">(</span><span class="n">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"alice"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">build</span><span class="o">());</span>
<span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">jsonMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
<span class="k">return</span> <span class="n">json</span><span class="o">;</span>
</pre></div></div></div>
<div class="paragraph"><p>Validate the response:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">responseJson</span> <span class="o">=</span> <span class="cm">/* ... */</span><span class="o">;</span>

<span class="n">PublicKeyCredential</span><span class="o">&lt;</span><span class="n">AuthenticatorAssertionResponse</span><span class="o">,</span> <span class="n">ClientAssertionExtensionOutputs</span><span class="o">&gt;</span> <span class="n">pkc</span> <span class="o">=</span>
    <span class="n">jsonMapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">responseJson</span><span class="o">,</span> <span class="k">new</span> <span class="n">TypeReference</span><span class="o">&lt;</span><span class="n">PublicKeyCredential</span><span class="o">&lt;</span><span class="n">AuthenticatorAssertionResponse</span><span class="o">,</span> <span class="n">ClientAssertionExtensionOutputs</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
<span class="o">});</span>

<span class="k">try</span> <span class="o">{</span>
    <span class="n">AssertionResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="na">finishAssertion</span><span class="o">(</span><span class="n">FinishAssertionOptions</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">request</span><span class="o">)</span>
        <span class="o">.</span><span class="na">response</span><span class="o">(</span><span class="n">pkc</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">());</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">isSuccess</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">getUsername</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">AssertionFailedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">"Authentication failed"</span><span class="o">);</span>
</pre></div></div></div>
<div class="paragraph"><p>For more detailed example usage, see
<a href="webauthn-server-demo"><code>webauthn-server-demo</code></a> for a complete demo server.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture">Architecture</h2>
<div class="sectionbody">
<div class="paragraph"><p>The library tries to place as few requirements on the overall application
architecture as possible. For this reason it is stateless and free from side
effects, and does not directly interact with any database. This means it is
database agnostic and thread safe. The following diagram illustrates an example
architecture for an application using the library.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img alt="Example application architecture" src="https://raw.githubusercontent.com/Yubico/java-webauthn-server/master/docs/img/demo-architecture.svg?sanitize=true">
</img></div>
</div>
<div class="paragraph"><p>The application manages all state and database access, and communicates with the
library via POJO representations of requests and responses. The following
diagram illustrates the data flow during a WebAuthn registration or
authentication ceremony.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img alt="WebAuthn ceremony sequence diagram" src="https://raw.githubusercontent.com/Yubico/java-webauthn-server/master/docs/img/demo-sequence-diagram.svg?sanitize=true">
</img></div>
</div>
<div class="paragraph"><p>In this diagram, the <strong>Client</strong> is the userâ€™s browser and the applicationâ€™s
client-side scripts. The <strong>Server</strong> is the application and its business logic, the
<strong>Library</strong> is this library, and the <strong>Users</strong> database stores registered WebAuthn
credentials.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
The client requests to start the ceremony, for example by submitting a form.
  The <code>username</code> may or may not be known at this point. For example, the user
  might be requesting to create a new account, or we might be using
  username-less authentication.
</p>
</li>
<li>
<p>
If the user does not already have a
  <a href="https://www.w3.org/TR/webauthn/#user-handle">user handle</a>, the application
  creates one in some application-specific way.
</p>
</li>
<li>
<p>
The application may choose to authenticate the user with a password or the
  like before proceeding.
</p>
</li>
<li>
<p>
The application calls one of the libraryâ€™s "start" methods to generate a
  parameter object to be passed to <code>navigator.credentials.create()</code> or <code>.get()</code>
  on the client.
</p>
</li>
<li>
<p>
The library generates a random challenge and an assortment of other arguments
  depending on configuration set by the application.
</p>
</li>
<li>
<p>
If the <code>username</code> is known, the library uses a read-only database adapter
  provided by the application to look up the userâ€™s credentials.
</p>
</li>
<li>
<p>
The returned list of <a href="https://www.w3.org/TR/webauthn/#credential-id">credential
  IDs</a> is used to populate the
  <a href="https://www.w3.org/TR/webauthn/#dom-publickeycredentialcreationoptions-excludecredentials"><code>excludeCredentials</code></a>
  or
  <a href="https://www.w3.org/TR/webauthn/#dom-publickeycredentialrequestoptions-allowcredentials"><code>allowCredentials</code></a>
  parameter.
</p>
</li>
<li>
<p>
The library returns a <code>request</code> object which can be serialized to JSON and
  passed as the <code>publicKey</code> argument to <code>navigator.credentials.create()</code> or
  <code>.get()</code>. For registration ceremonies this will be a
  <a href="https://www.w3.org/TR/webauthn/#dictdef-publickeycredentialcreationoptions"><code>PublicKeyCredentialCreationOptions</code></a>,
  and for authentication ceremonies it will be a
  <a href="https://www.w3.org/TR/webauthn/#dictdef-publickeycredentialrequestoptions"><code>PublicKeyCredentialRequestOptions</code></a>.
  The application stores the <code>request</code> in temporary storage.
</p>
</li>
<li>
<p>
The applicationâ€™s client-side script runs <code>navigator.credentials.create()</code> or
  <code>.get()</code> with <code>response</code> as the <code>publicKey</code> argument.
</p>
</li>
<li>
<p>
The user confirms the operation and the client returns a
  <a href="https://www.w3.org/TR/webauthn/#public-key-credential"><code>PublicKeyCredential</code></a>
  object <code>response</code> to the application.
</p>
</li>
<li>
<p>
The application retrieves the <code>request</code> from temporary storage and passes
  <code>request</code> and <code>response</code> to one of the libraryâ€™s "finish" methods to run the
  response validation logic.
</p>
</li>
<li>
<p>
The library verifies that the <code>response</code> contents - challenge, origin, etc. -
  are valid.
</p>
</li>
<li>
<p>
If this is an authentication ceremony, the library uses the database adapter
  to look up the public key for the credential named in <code>response.id</code>.
</p>
</li>
<li>
<p>
The database adapter returns the public key.
</p>
</li>
<li>
<p>
The library verifies the authentication signature.
</p>
</li>
<li>
<p>
The library returns a POJO representation of the result of the ceremony. For
  registration ceremonies, this will include the credential ID and public key of
  the new credential. The application may also opt in to also getting
  information about the authenticator model and whether the authenticator
  attestation is trusted. For authentication ceremonies, this will include the
  username and user handle, the credential ID of the credential used, and the
  new <a href="https://www.w3.org/TR/webauthn/#signature-counter">signature counter</a> value
  for the credential.
</p>
</li>
<li>
<p>
The application inspects the result object and takes any appropriate actions
  as defined by its business logic.
</p>
</li>
<li>
<p>
If the result is not satisfactory, the application reports failure to the
  client.
</p>
</li>
<li>
<p>
If the result is satisfactory, the application proceeds with storing the new
  credential if this is a registration ceremony.
</p>
</li>
<li>
<p>
If this is an authentication ceremony, the application updates the signature
  counter stored in the database for the credential.
</p>
</li>
<li>
<p>
Finally, the application reports success and resumes its business logic.
</p>
</li>
</ol></div>
</div>
</div>
<div class="sect1">
<h2 id="_building">Building</h2>
<div class="sectionbody">
<div class="paragraph"><p>Use the included
<a href="https://docs.gradle.org/current/userguide/gradle_wrapper.html">Gradle wrapper</a> to
build the <code>.jar</code> artifact:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>$ ./gradlew :webauthn-server-core:jar</pre>
</div></div>
<div class="paragraph"><p>The output is built in the <code>webauthn-server-core/build/libs/</code> directory, and the
version is derived from the most recent Git tag. Builds done on a tagged commit
will have a plain <code>x.y.z</code> version number, while a build on any other commit will
result in a version number containing the abbreviated commit hash.</p></div>
<div class="paragraph"><p>Although the <code>.jar</code> artifact of this project can be used in JDK version 8 or
later, the project as a whole currently builds only in JDK 8. This is because
most tests are written in Scala, which
<a href="https://docs.scala-lang.org/overviews/jdk-compatibility/overview.html#jdk-9--up-compatibility-notes">currently
only supports JDK 8</a>. Therefore compiling the tests can currently only be done
in JDK 8, and so <code>./gradlew build</code> and similar tasks will fail in JDKs other
than 8.</p></div>
<div class="paragraph"><p>To run the tests (requires JDK 8):</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>$ ./gradlew check</pre>
</div></div>
<div class="paragraph"><p>To run the <a href="http://pitest.org/">PIT mutation tests</a> (requires JDK 8):</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>$ ./gradlew pitest</pre>
</div></div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>