<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>yubico-pam</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li class="active">yubico-pam</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/yubico-pam">yubico-pam</a><ul class="">
<li><a href="/yubico-pam/Release_Notes.html">Release Notes</a></li>
<li><a href="/yubico-pam/Authentication_Using_Challenge-Response.html">Authentication Using Challenge-Response</a></li>
<li><a href="/yubico-pam/MacOS_X_Challenge-Response.html">MacOS X Challenge-Response</a></li>
<li><a href="/yubico-pam/Two_Factor_PAM_Configuration.html">Two Factor PAM Configuration</a></li>
<li><a href="/yubico-pam/Ubuntu_FreeRadius_YubiKey.html">Ubuntu FreeRadius YubiKey</a></li>
<li><a href="/yubico-pam/YubiKey_and_FreeRADIUS_1FA_via_PAM.html">YubiKey and FreeRADIUS 1FA via PAM</a></li>
<li><a href="/yubico-pam/YubiKey_and_FreeRADIUS_via_PAM.html">YubiKey and FreeRADIUS via PAM</a></li>
<li><a href="/yubico-pam/YubiKey_and_OpenVPN_via_PAM.html">YubiKey and OpenVPN via PAM</a></li>
<li><a href="/yubico-pam/YubiKey_and_Radius_via_PAM.html">YubiKey and Radius via PAM</a></li>
<li><a href="/yubico-pam/YubiKey_and_SELinux_on_Fedora_18_and_up.html">YubiKey and SELinux on Fedora 18 and up</a></li>
<li><a href="/yubico-pam/YubiKey_and_SSH_via_PAM.html">YubiKey and SSH via PAM</a></li>
</ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/yubico-pam" rel="noopener noreferrer" target="_blank"><i class="fa fa-github fa-lg"></i> Github</a></li>
</ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_yubico_pam_module">Yubico PAM module</h1>
<div class="sectionbody">
<div class="paragraph"><p><span class="image">
<a class="image" href="https://travis-ci.org/Yubico/yubico-pam" rel="noopener noreferrer" target="_blank">
<img alt="Build Status" src="https://travis-ci.org/Yubico/yubico-pam.svg?branch=master">
</img></a>
</span></p></div>
<div class="paragraph"><p>The Yubico PAM module provides an easy way to integrate the YubiKey
into your existing user authentication infrastructure. PAM is used by
GNU/Linux, Solaris and Mac OS X for user authentication, and by other
specialized applications such as NCSA MyProxy.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_status_and_roadmap">Status and Roadmap</h2>
<div class="sectionbody">
<div class="paragraph"><p>The module is working for multi-user systems. The primary mode of
operation is by doing online validation using a YubiKey validation
service (such as the YubiCloud, or a private one configured using
the <em>urllist</em> parameter).</p></div>
<div class="paragraph"><p>In version 2.6, offline validation was also made possible through
the use of HMAC-SHA1 Challenge-Response found in YubiKey 2.2 and
later. This has introduced a dependency of libykpers-1 from the
ykpersonalize package. Pass <code>--without-cr</code> to <code>configure</code> to avoid
this dependency.</p></div>
<div class="paragraph"><p>The development community is co-ordinated via
<a href="https://github.com/Yubico/yubico-pam" rel="noopener noreferrer" target="_blank">the GitHub project page</a>.</p></div>
<div class="paragraph"><p>The project is licensed under a BSD license. See the file COPYING for
exact wording. For any copyright year range specified as YYYY-ZZZZ in
this package note that the range specifies every single year in that
closed interval.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_building_from_git">Building from Git</h2>
<div class="sectionbody">
<div class="paragraph"><p>Skip to the next section if you are using an official packaged
version.</p></div>
<div class="paragraph"><p>You may check out the sources using Git with the following command:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>git clone https://github.com/Yubico/yubico-pam.git
</pre>
</div></div>
<div class="paragraph"><p>This will create the directory <code>yubico-pam</code>.</p></div>
<div class="paragraph"><p>Autoconf, automake, libtool, asciidoc, xsltproc and docbook-xsl must be installed to create a
compilable source tree.</p></div>
<div class="paragraph"><p>Generate the build system using:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>cd yubico-pam
<span class="sh-dollar"></span>autoreconf --install
</pre>
</div></div>
<div class="sect2">
<h3 id="_building">Building</h3>
<div class="paragraph"><p>You will need to have <a href="https://developers.yubico.com/yubico-c-client">libykclient</a>
(ykclient.h, libykclient.so) and libpam-dev (security/pam_appl.h, libpam.so)
installed. It in turn requires cURL, which you need to have installed, and
<a href="https://developers.yubico.com/yubico-c">libyubikey</a>.</p></div>
<div class="paragraph"><p>The Challenge-Response offline authentication requires libykpers-1
from the
<a href="https://developers.yubico.com/yubikey-personalization">yubikey-personalization</a>
project:</p></div>
<div class="paragraph"><p>The selftests require perl with the module Net::LDAP::Server installed.</p></div>
<div class="paragraph"><p>The build system uses Autoconf, to set up the build system run:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>./configure</pre>
</div></div>
<div class="paragraph"><p>Use --without-ldap to disable ldap support.</p></div>
<div class="paragraph"><p>Then build the code, run the self-test and install the binaries:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>make check install</pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_fedora_epel">Fedora/EPEL</h3>
<div class="paragraph"><p>There is already a package in Fedora/EPEL of yubico-pam that can be installed
by using yum:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>sudo yum install pam_yubico
</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_ubuntu_ppa">Ubuntu PPA</h3>
<div class="paragraph"><p>There is an Ubuntu PPA (Personal Package Archive) for yubico-pam that
can be installed using the following commands on reasonably modern
Ubuntu platforms :</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>sudo add-apt-repository ppa:yubico/stable
<span class="sh-dollar"></span>sudo apt-get update
<span class="sh-dollar"></span>sudo apt-get install libpam-yubico
</pre>
</div></div>
<div class="paragraph"><p>See the file <code>/usr/share/doc/libpam-yubico/README.Debian</code> after installing.</p></div>
</div>
<div class="sect2">
<h3 id="_freebsd_ports">FreeBSD ports</h3>
<div class="paragraph"><p>yubico-pam and the supporting Yubico packages have corresponding FreeBSD ports. To install:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>
<span class="sh-dollar"></span>cd /usr/ports/security/pam_yubico
<span class="sh-dollar"></span>make install clean
</pre>
</div></div>
<div class="paragraph"><p>Advanced configuration notes are available <a href="http://mjslabs.com/yubihow.html" rel="noopener noreferrer" target="_blank">here</a>.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">Configuration</h2>
<div class="sectionbody">
<div class="paragraph"><p>Install it in your PAM setup by adding a line to an appropriate file
in <code>/etc/pam.d/</code>:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>auth sufficient pam_yubico.so id=[Your API Client ID] debug</pre>
</div></div>
<div class="paragraph"><p>and move pam_yubico.so into /lib/security/ (or wherever PAM modules
live in your system) :</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>mv /usr/local/lib/security/pam_yubico.so /lib/security/</pre>
</div></div>
<div class="paragraph"><p>For more information, see the project documentation.</p></div>
<div class="paragraph"><p>Supported PAM module parameters are:</p></div>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
authfile
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
To indicate the location of the file that holds the
mappings of YubiKey token IDs to user names.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
id
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
Your API Client ID in the Yubico validation server.
If you want to use the default YubiCloud service,
go <a href="https://upgrade.yubico.com/getapikey" rel="noopener noreferrer" target="_blank">here</a>.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
key
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
To indicate your client key in base64 format.
The client key is also known as API key, and provides
integrity in the communication between the client (you)
and the validation server.
If you want to get one for use with the default YubiCloud
service, go <a href="https://upgrade.yubico.com/getapikey" rel="noopener noreferrer" target="_blank">here</a>.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
debug
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
to enable debug output.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
debug_file
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
filename to write debug to, file must exist and
be a regular file. stdout is default.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
alwaysok
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
to enable all authentication attempts to succeed
(aka presentation mode).
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
try_first_pass
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
Before prompting the user for their password, the module
first tries the previous stacked module´s password in case
that satisfies this module as well.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
use_first_pass
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
The argument use_first_pass forces the module to use a previous
stacked modules password and will never prompt the user - if no
password is available or the password is not appropriate, the user
will be denied access.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
always_prompt
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
If set, don’t attempt to do a lookup to determine if the user has a
YubiKey configured but instead prompt for one no matter what. This
is useful in the case where ldap_bind_as_user is enabled but this
module is being used to read the user’s password (in a YubiKey+OTP
auth scenario).
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
nullok
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
If set, don’t fail when there are no tokens declared for the user
in the authorization mapping files or in LDAP.
This can be used to make YubiKey authentication optional unless
the user has associated tokens.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldap_starttls
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
If set, issue a STARTTLS command to the LDAP connection before
attempting to bind to it. This is a common setup for servers
that only listen on port 389 but still require TLS.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldap_bind_as_user
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
If set, use the user logging in to bind to LDAP. This will use the
password provided by the user via PAM. If this is set, ldapdn
and uid_attr must also be set.  Enabling this will cause
<em>ldap_bind_user</em> and <em>ldap_bind_password</em> to be ignored
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
urllist
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
List  of  URL  templates to be used. This is set by calling
ykclient_set_url_bases. The list should be in the format :
<code>https://server/wsapi/2.0/verify;https://server/wsapi/2.0/verify</code>
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
url
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
This option should not be used, please use the urllist
option instead.
Specify the URL template to use, this is set by calling
yubikey_client_set_url_template, which defaults to:
<code>https://api.yubico.com/wsapi/verify?id=%d&amp;otp=%s</code>
or
<code>https://api.yubico.com/wsapi/2.0/verify?id=%d&amp;otp=%s</code>
depending on your version of yubico-c-client.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
capath
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
specify the path where X509 certificates are stored. This is
required if <em>https</em> or <em>ldaps</em> are used in <em>url</em> and <em>ldap_uri</em>
respectively.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
cainfo
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
Option to allow usage of a CA bundle instead of path.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
proxy
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
specify a proxy to connect to the validation server. Valid schemes are
http://, https://, socks4://, socks4a://, socks5:// or socks5h://.
Socks5h asks the proxy to do the dns resolving. If no scheme or port is
specified HTTP proxy port 1080 will be used.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
verbose_otp
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
   This argument is used to show the OTP (One-Time Password) when it
   is entered, i.e. to enable terminal echo of entered characters.
   You are advised to not use this, if you are using two factor
   authentication because that will display your password on the
   screen.
   This requires the service using the PAM module to
   display custom fields. This option can not be used with OpenSSH.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldap_uri
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
specify the LDAP server URI (e.g. ldap://localhost).
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldapserver
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
specify the LDAP server host (default LDAP port is used).
<em>Deprecated. Use "ldap_uri" instead.</em>
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldapdn
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
specify the dn where the users are stored
(eg: ou=users,dc=domain,dc=com).
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldap_clientcertfile
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
The path to a client cert file to use when talking to the LDAP
server.  Note this requires <em>ldap_clientkeyfile</em> to be set as well.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldap_clientkeyfile
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
The path to a key to be used with the client cert when talking to
the LDAP server.  Note this requires <em>ldap_clientcertfile</em> to be
set as well.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldap_bind_user
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
The user to attempt a LDAP bind as.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldap_bind_password
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
The password to use on LDAP bind.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldap_filter
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
An LDAP filter to use for attempting to find the correct object in LDAP. In this string <code>%u</code> will be replaced with the username.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
ldap_cacertfile
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
CA certifcate file for the LDAP connection.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
user_attr
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
specify the LDAP attribute used to store user names (eg:cn).
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
yubi_attr
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
specify the LDAP attribute used to store the YubiKey ID.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
yubi_attr_prefix
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
specify the prefix of the LDAP attribute’s value, in case
of a generic attribute, used to store several types of IDs.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
token_id_length
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
Length of ID prefixing the OTP (this is 12 if using the
YubiCloud).
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
mode
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
Mode of operation. Use "client" for online validation with
a YubiKey validation service such as the YubiCloud, or use
"challenge-response" for offline validation using YubiKeys
with HMAC-SHA-1 Challenge-Response configurations. See the
man-page ykpamcfg(1) for further details on how to configure
offline Challenge-Response validation.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
chalresp_path
<br>
</br></td>
<td class="hdlist2">
<p style="margin-top: 0;">
Directory that is used to store the challenge files in case of a system-wide
configuration (in contrast to challenge files being stored in a user’s home
directory). This location should be only readable and writable by root. Refer
to <code>Authentication_Using_Challenge-Response.adoc</code> for more information about
such a setup.
</p>
</td>
</tr>
</table></div>
<div class="paragraph"><p>If you are using "debug" you may find it useful to create a
world-writable log file:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span>touch /var/run/pam-debug.log
chmod go+w /var/run/pam-debug.log
</pre></div></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">Please remember, physical access to systems often allows the circumvention of security controls. If an attacker has physical access to your system (such as a laptop left in a hotel room) and can boot into single user mode, they can disable yubico-pam in your system configuration.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authorization_mapping_files">Authorization Mapping Files</h2>
<div class="sectionbody">
<div class="paragraph"><p>A mapping must be made between the YubiKey token ID and the user ID it is
attached to. There are two ways to do this, either centrally in one file, or
individually, where users can create the mapping in their home directories.
If the central authorization mapping file is being used, user home directory
mappings will not be used and the opposite applies if user home directory
mappings are being used, the central authorization mappings file will not
be used.</p></div>
<div class="sect2">
<h3 id="_central_authorization_mapping">Central authorization mapping</h3>
<div class="paragraph"><p>Create a <code>/etc/yubikey_mappings</code>, the file must contain a user name and the
YubiKey token ID separated by colons (same format as the passwd file) for
each user you want to allow onto the system using a YubiKey.</p></div>
<div class="paragraph"><p>The mappings should look like this, one per line:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;first user name&gt;:&lt;YubiKey token ID1&gt;:&lt;YubiKey token ID2&gt;:….
&lt;second user name&gt;:&lt;YubiKey token ID3&gt;:&lt;YubiKey token ID4&gt;:….</pre>
</div></div>
<div class="paragraph"><p>Now add <code>authfile=/etc/yubikey_mappings</code> to your PAM configuration line, so it
looks like:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>auth sufficient pam_yubico.so id=[Your API Client ID] authfile=/etc/yubikey_mappings</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_individual_authorization_mapping_by_user">Individual authorization mapping by user</h3>
<div class="paragraph"><p>Each user creates a <code>~/.yubico/authorized_yubikeys</code> file inside of their home
directory and places the mapping in that file, the file must have only one
line:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;user name&gt;:&lt;YubiKey token ID1&gt;:&lt;YubiKey token ID2&gt;</pre>
</div></div>
<div class="paragraph"><p>This is much the same concept as the SSH authorized_keys file.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_obtaining_the_yubikey_token_id_a_k_a_public_id">Obtaining the YubiKey token ID (a.k.a. public ID)</h2>
<div class="sectionbody">
<div class="paragraph"><p>You can obtain the YubiKey token ID in several ways. One is by
removing the last 32 characters of any OTP (One Time Password)
generated with your YubiKey. Another is by using the
<a href="http://demo.yubico.com/php-yubico/Modhex_Calculator.php" rel="noopener noreferrer" target="_blank">modhex calculator</a>.</p></div>
<div class="paragraph"><p>Enter your YubiKey OTP and convert it, your YubiKey token ID is 12
characters and listed as:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>Modhex encoded: XXXXXXX</pre>
</div></div>
<div class="paragraph"><p>Not sure what that last bit meant? Here is how to get a copy of your OTP.</p></div>
<div class="sect2">
<h3 id="_fast_way">Fast way</h3>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Open a terminal
</p>
</li>
<li>
<p>
Press the YubiKey’s button
  It will output an OTP into the shell:
</p>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span>$ cccccccgklgcvnkcvnnegrnhgrjkhlkfhdkclfncvlgj
bash: cccccccgklgcvnkcvnnegrnhgrjkhlkfhdkclfncvlgj: <span class="nb">command</span> not found
</pre></div></div></div>
<div class="paragraph"><p>This can be pasted into the Modhex_Calculator page.</p></div>
</li>
</ol></div>
</div>
<div class="sect2">
<h3 id="_harder_way">Harder way</h3>
<div class="paragraph"><p>This requires you to have the pam module enabled with <em>debug</em> turned on. When
prompted for the YubiKey press the button. The pam module will print out debug
information including the OTP and ID of your token to the shell — copy the ID
into your config file and you should be up and going.</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>YubiKey for `youruser':
[pam_yubico.c:pam_sm_authenticate(867)] conv returned 44 bytes
[pam_yubico.c:pam_sm_authenticate(885)] Skipping first 0 bytes. Length is 44, token_id set to 12 and token OTP always 32.
[pam_yubico.c:pam_sm_authenticate(892)] OTP: ccccccclabcabkhbdncicglfltnukadfoifadfhhhhfe ID: cccccclabcab</pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_yubico_pam_module_and_selinux">Yubico PAM module and SELinux.</h2>
<div class="sectionbody">
<div class="paragraph"><p>Users with SELinux in enforcing mode (the default on Fedora 17+) may experience
login problems with services including those validated via
polkit-agent-helper-1, sshd and login.</p></div>
<div class="paragraph"><p>This is <a href="https://bugzilla.redhat.com/show_bug.cgi?id=841693#c3" rel="noopener noreferrer" target="_blank">documented in Red Hat bugzilla</a>
including a work around for ssh (Equivalent files could be created for
other services). Systems in <em>permissive</em> mode will generate AVC warnings but
authentication will succeed.</p></div>
<div class="paragraph"><p>To determine if you have SELinux enforcing or not run the <code>sestatus</code> command.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_examples">Examples</h2>
<div class="sectionbody">
<div class="paragraph"><p>If you want to use the YubiKey to authenticate you on Linux console
logins, add the following to the top of <code>/etc/pam.d/login</code>:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>auth sufficient pam_yubico.so id=[Your API Client ID] debug</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_openvpn_and_activedirectory">OpenVPN and ActiveDirectory</h2>
<div class="sectionbody">
<div class="paragraph"><p>See Michael Ludvig’s sample Active Directory schema extensions for YubiKey public ID attribute storage / association with a particular user account:  <a href="https://github.com/mludvig/yubikey-ldap/tree/master/microsoft-schema" rel="noopener noreferrer" target="_blank">https://github.com/mludvig/yubikey-ldap/tree/master/microsoft-schema</a></p></div>
<div class="paragraph"><p>create file <em>/etc/pam.d/openvpn</em>:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>auth  required  pam_yubico.so ldap_uri=ldap://contoso.com debug id=[Your API ID] yubi_attr=YubiKeyID
   ldapdn=DC=contoso,DC=com
   ldap_filter=(&amp;(sAMAccountName=%u)(objectClass=user)(memberOf=CN=somegroup,DC=contoso,DC=com))
   [ldap_bind_user=CN=binduser,OU=Service Accounts,DC=contoso,DC=com] ldap_bind_password=bind_password try_first_pass
account required  pam_yubico.so</pre>
</div></div>
<div class="paragraph"><p>create file <em>openvpn.conf</em></p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>plugin openvpn-plugin-auth-pam.so openvpn</pre>
</div></div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>