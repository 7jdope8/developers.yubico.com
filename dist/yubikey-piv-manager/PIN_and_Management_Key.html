<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>PIN and Management Key</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/yubikey-piv-manager">yubikey-piv-manager</a></li>
<li class="active">PIN and Management Key</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/yubikey-piv-manager">yubikey-piv-manager</a><ul class="">
<li><a href="/yubikey-piv-manager/Release_Notes.html">Release Notes</a></li>
<li><a href="/yubikey-piv-manager/Certificates.html">Certificates</a></li>
<li><a href="/yubikey-piv-manager/Device_Setup.html">Device Setup</a></li>
<li class="active"><a href="/yubikey-piv-manager/PIN_and_Management_Key.html">PIN and Management Key</a>
<li><a href="/yubikey-piv-manager/Settings_and_Group_Policy.html">Settings and Group Policy</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/yubikey-piv-manager" rel="noopener noreferrer" target="_blank"><i class="fa fa-github fa-lg"></i> Github</a></li>
</ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_pin_and_management_key">PIN and Management Key</h1>
<div class="sectionbody">
<div class="paragraph"><p>A PIV-enabled YubiKey has a PIN, a PUK and a Management Key. These can be
configured by using the <strong>Manage Device PINs</strong> window of the YubiKey PIV Manager.</p></div>
<div class="sect2">
<h3 id="_pin">PIN</h3>
<div class="paragraph"><p>The PIN is used during normal operation to authorize an action such as creating
a digital signature for any of the loaded certificates. Entering an incorrect
PIN three times consecutively will cause the PIN to become blocked, rendering
the PIV features unusable. The PIN must be at least 6 characters, and can
contain any characters, though for cross-platform portability it is recommended
to only use decimal digits. There is a limit of 8 bytes for a PIN, which allows
for up to 8 ASCII characters. There is a setting in the YubiKey PIV Manager,
which enforces password complexity rules on your PIN (as well as your PUK). If
this setting is active, your PIN will need to:</p></div>
<div class="ulist"><ul>
<li>
<p>
Not contain all or part of the user’s account name.
</p>
</li>
<li>
<p>
Contain characters from three of the following four categories:
</p>
<div class="ulist"><ul>
<li>
<p>
English uppercase characters (A through Z)
</p>
</li>
<li>
<p>
English lowercase characters (a through z)
</p>
</li>
<li>
<p>
Base 10 digits (0 through 9)
</p>
</li>
<li>
<p>
Nonalphanumeric characters (e.g., !, $, #, %)
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="sect3">
<h4 id="_pin_expiration">PIN expiration</h4>
<div class="paragraph"><p>There is an option in the YubiKey PIV Manager to enforce PINs to expire after a
certain number of days, requiring you to change your PIN periodically. This is
not enabled by default. When enabled, the YubiKey PIV Manager will prompt you
to change the PIN after the set number of days has passed. Changing the PIN
using an external tool will not affect the PIN expiration date. When this
option is enabled you will need to provide your Management Key each time the
PIN is changed, as that is required to store the updated expiration time.
Because of this it is often desirable to use your PIN as the Management Key in
combination with this setting to not be prompted for the Key.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_management_key">Management Key</h3>
<div class="paragraph"><p>All PIV management operation of the YubiKey require a 24 byte 3DES key, known
as the Management Key. You can either explicitly set a 24 byte key (the YubiKey
PIV Manager can generate one for you), or you can choose to not set a
Management Key, instead using the PIN for these operations. If so, you will be
asked to provide your PIN instead of your Management Key whenever you perform a
management operation, such as importing a new certificate, or generating a new
key pair.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">See the section Considerations when using a PIN for PIV management!</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_puk">PUK</h3>
<div class="paragraph"><p>The PUK can be used to reset the PIN if it is ever lost or becomes blocked
after the maximum number of incorrect attempts. Setting a PUK is optional. If
you use your PIN as the Management Key, the PUK is disabled for technical
reasons, explained in a later section. The requirements and restrictions of the
PUK are the same as for the PIN (see above). If PIN complexity is enforced, the
same rules are applied to the PUK. If the PUK ever becomes blocked, either by
deliberately choosing to block it or by giving the wrong PUK value 3 times, it
can only be unblocked by performing a complete reset (explained below).</p></div>
</div>
<div class="sect2">
<h3 id="_resetting_a_device">Resetting a device</h3>
<div class="paragraph"><p>If an incorrect PIN is given 3 times consecutively, the PIN will become
disabled. If you’ve set a PUK, then you can use that PUK to reset the PIN to a
new value, and it will become enabled and usable again. If an incorrect PUK is
given 3 times consecutively, it will become blocked as well. When both the PIN
and the PUK are blocked, the device can be reset. This returns the PIV
functionality of the YubiKey to a factory setting, setting the default PIN, PUK
and Management Key values, as well as removing any stored keys and
certificates. Once reset, the device is ready to be re-initialized.</p></div>
</div>
<div class="sect2">
<h3 id="_considerations_when_using_a_pin_for_piv_management">Considerations when using a PIN for PIV management</h3>
<div class="paragraph"><p>There are certain security and usability considerations which should be taken
into account when using the PIN for PIV management, instead of a Management
Key. The way this feature works, is that a Management Key is still used, but it
is cryptographically derived from your PIN by the YubiKey PIV Manager, behind
the scenes. One implication of this is that the Management Key changes whenever
you change your PIN, and it is therefore crucial that you ONLY change your PIN
using the YubiKey PIN Manager. Changing it using an external tool will render
the YubiKey PIV Manager unable to derive the Management Key. There is also a
security aspect to be aware of, and that is that even though the PIN is blocked
if entered incorrectly 3 times, the Management Key is not. An attacker could
use the knowledge of this to effectively brute-force the PIN. This is mitigated
by a computationally expensive (slow) key derivation, but it should only be
used with a long, complex PIN.</p></div>
<div class="sect3">
<h4 id="_technical_description_of_key_derivation_from_pin">Technical description of Key derivation from PIN</h4>
<div class="paragraph"><p>When choosing to use a Management Key derived from the PIN, the following takes
place:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
A random 8-byte SALT value is generated and stored on the YubiKey.
</p>
</li>
<li>
<p>
The derived Management Key is calculated as PBKDF2(PIN, SALT, 24, 10000).
</p>
</li>
</ol></div>
<div class="paragraph"><p>The PBKDF2 function (described in RFC 2898) is run using the PIN (encoded using
UTF-8) as the password, for 10000 rounds, to produce a 24 byte key, which is
used as the management key. Whenever the user changes the PIN this process is
repeated, using a new SALT and the new PIN.</p></div>
</div>
</div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>