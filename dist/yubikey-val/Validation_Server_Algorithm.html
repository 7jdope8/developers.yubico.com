<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>Validation Server Algorithm</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/yubikey-val">yubikey-val</a></li>
<li class="active">Validation Server Algorithm</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/yubikey-val">yubikey-val</a><ul class="">
<li><a href="/yubikey-val/Release_Notes.html">Release Notes</a></li>
<li><a href="/yubikey-val/Installation.html">Installation</a></li>
<li><a href="/yubikey-val/Troubleshooting.html">Troubleshooting</a></li>
<li><a href="/yubikey-val/Client_Info_Format.html">Client Info Format</a></li>
<li><a href="/yubikey-val/Generating_Clients.html">Generating Clients</a></li>
<li><a href="/yubikey-val/Getting_Started_Writing_Clients.html">Getting Started Writing Clients</a></li>
<li><a href="/yubikey-val/Import_Export_Data.html">Import Export Data</a></li>
<li><a href="/yubikey-val/Make_Release.html">Make Release</a></li>
<li><a href="/yubikey-val/Munin_Probes.html">Munin Probes</a></li>
<li><a href="/yubikey-val/Revocation_Service.html">Revocation Service</a></li>
<li><a href="/yubikey-val/Server_Replication_Protocol.html">Server Replication Protocol</a></li>
<li><a href="/yubikey-val/Sync_Monitor.html">Sync Monitor</a></li>
<li><a href="/yubikey-val/Validation_Protocol_V2.0.html">Validation Protocol V2.0</a></li>
<li class="active"><a href="/yubikey-val/Validation_Server_Algorithm.html">Validation Server Algorithm</a>
<li><a href="/yubikey-val/YubiKey_Info_Format.html">YubiKey Info Format</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/yubikey-val" rel="noopener noreferrer" target="_blank"><i class="fa fa-github fa-lg"></i> Github</a></li>
</ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_validation_server_algorithm">Validation Server Algorithm</h1>
<div class="sectionbody">
<div class="paragraph"><p>This document describes how a validation server should be implemented,
and the required steps it needs to perform in order to be secure.</p></div>
<div class="paragraph"><p>The client-to-server protocol is described in
<a href="Validation_Protocol_V2.0.html">Validation Protocol V2.0</a> and the
server-to-server protocol is described in
lnk:Server_Replication_Protocol.adoc[Server Replication Protocol].</p></div>
<div class="sect2">
<h3 id="_normal_validation_with_sync">Normal validation with Sync</h3>
<div class="paragraph"><p>Val X receives an OTP verify request and needs to update the other
validation servers on the last seen counter values. The procedure is
as follows</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Val X parses validation request, retrieves the client key for the client id from local database and checks the request signature.
</p>
</li>
<li>
<p>
Val X decrypts the OTP using a KSM and reads out the modified/counters from the internal database — if the YubiKey identity doesn’t exist in the database, add it with counter/use/high/low=-1.
</p>
</li>
<li>
<p>
Val X checks the OTP/Nonce against local database, and replies with REPLAYED_REQUEST if local information is identical.
</p>
</li>
<li>
<p>
Val X checks the OTP counters against local counters, and rejects OTP as replayed if local counters are higher than or equal to OTP counters.
</p>
</li>
<li>
<p>
Val X updates the internal database with counters/nonce from request.
</p>
</li>
<li>
<p>
Val X queues a sync request in a sync queue for each validation server in the validation server pool (manually configured).
</p>
</li>
<li>
<p>
Val X requests the queued requests (otp, modified, nonce, yk_identity, yk_counter, yk_use, yk_high, yk_low) to be sent out, by sending parallel sync requests to all other validation servers.
</p>
</li>
<li>
<p>
Each validation server receiving a sync request updates its own internal database with received information to use the highest counter.
</p>
</li>
<li>
<p>
Each remote server responds with a sync response (modified, nonce, yk_identity, yk_counter, yk_use, yk_high, yk_low) using data from its internal database.
</p>
</li>
<li>
<p>
Val X waits for a sync response (up until timeout, or when sufficient number of sync responses indicating valid OTP and no sync response indicating invalid OTP) from the other validation servers to which it sent a sync request. For each response that arrives the corresponding entry in the sync queue is removed and the following is checked
</p>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
If the sync response counters have higher values than val X internal database, the internal database is updated with new information, AND
</p>
</li>
<li>
<p>
If the sync response counter have higher values as val X internal database the response is considered to mark the OTP as invalid, AND
</p>
</li>
<li>
<p>
If the sync response have equal counter values and nonce as val X internal database the response is considered to mark the OTP as valid, AND
</p>
</li>
<li>
<p>
If the sync response have equal counter values and different nonce as val X internal database the response is considered to mark the OTP as invalid, AND
</p>
</li>
<li>
<p>
If the sync response counter have smaller values than val X had in its internal database before the validation attempt the server logs a warning, and the response is considered to mark the OTP as valid.
</p>
</li>
</ol></div>
</li>
<li>
<p>
Val X construct validation response.  Validation is successful if the Verification Algorithm below is successful.
</p>
</li>
<li>
<p>
Val X marks the remaining entries in the sync queue as marked with timestamp=NULL.
</p>
</li>
</ol></div>
<div class="paragraph"><p>Any remaining sync requests in the sync queue are from now on handled
by a background daemon which re-sends them at regular intervals
(described below).</p></div>
<div class="sect3">
<h4 id="_verification_algorithm">Verification algorithm</h4>
<div class="literalblock">
<div class="content monospaced">
<pre>Input:
  otp - the otp
  nonce - the nonce from the request
  yk:counter - the session counter
  yk:use - the session use counter
  yk:high - the high timestamp
  yk:low - the low timestamp
  modified - when the counters were last modified

Output:
  Error code.</pre>
</div></div>
<div class="paragraph"><p>Val X requires that SL % of the sent sync requests gives a response
marking the OTP as valid, and that none of the responses indicate the
OTP is invalid, in order to consider the OTP to be valid.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
If internal database counters are equal to otp counters AND nonce is identical, then return REPLAYED_REQUEST.
</p>
</li>
<li>
<p>
If internal database counters are higher/equal to otp counters, then return REPLAYED_OTP.
</p>
</li>
<li>
<p>
If any counter in sync response are higher/equal to otp counters, then return REPLAYED_OTP.
</p>
</li>
<li>
<p>
If insufficient number of sync responses are received, then return NOT_ENOUGH_ANSWERS.
</p>
</li>
<li>
<p>
(optional: if phishing test fails, return DELAYED_OTP)
</p>
</li>
<li>
<p>
return OK
</p>
</li>
</ol></div>
</div>
<div class="sect3">
<h4 id="_warning_algorithm">Warning algorithm</h4>
<div class="paragraph"><p>Warn if any of these are true:</p></div>
<div class="ulist"><ul>
<li>
<p>
If received sync response have lower counters than locally saved last counters (indicating that remote server wasn’t synced)
</p>
</li>
<li>
<p>
If received sync response have higher counters than locally saved last counters (indicating that local server wasn’t synced)
</p>
</li>
<li>
<p>
If received sync response have counters higher than or equal to the OTP counters (indicating that the OTP is replayed)
</p>
</li>
<li>
<p>
If received sync request have counters equal to local counters and modified field equal to local modified field (sync request has been unnecessarily resent).
</p>
</li>
<li>
<p>
If received sync request have counters equal to local counters and modified field different to local modified field (We might have a replay. 2 events at different times have generated the same counters)
</p>
</li>
<li>
<p>
If received sync request have lower counters than local (indicating that remote server is not synced)
</p>
</li>
<li>
<p>
If received sync request have identical counters but different nonce (indicating that remote server received a request to validate an already validated OTP)
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="_update_validation_server_that_has_been_offline">Update validation server that has been offline</h4>
<div class="paragraph"><p>Val X has been out of function and its internal database needs to be
updated.</p></div>
<div class="paragraph"><p>This case is handled automatically since the sync requests which did
not succeed immediately in the previous point are queued.</p></div>
<div class="paragraph"><p>When val X is accessible again, all the sync requests in queue are
re-sent and val X database is updated.</p></div>
<div class="paragraph"><p>Responses which would have caused the sender of the sync request to
consider the OTP as invalid will give raise to a warning on the sender
validation server.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_sync_queue_daemon">Sync queue daemon</h3>
<div class="paragraph"><p>There is one queue daemon that is responsible for sending all the
queued requests.</p></div>
<div class="paragraph"><p>The sync queue will loop the following algorithm.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Get a list of all remote server from the database; S1, S2, …
</p>
</li>
<li>
<p>
For each remote server S in the list S1, S2, … do
</p>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
For each entry in the queue table for S which have a queued_time==NULL or a timestamp older than a configured period (e.g., one minute) do
</p>
<div class="olist lowerroman"><ol class="lowerroman">
<li>
<p>
Send one request, using a configured timeout value (e.g., 30 seconds).
</p>
</li>
<li>
<p>
If the request is unsuccessful (or times out), quit to the outer loop.
</p>
</li>
<li>
<p>
The request was successful so the sync daemon receives counter/nonce values from the remote server.
</p>
</li>
<li>
<p>
If the sync response counters are lower, give a warning
</p>
</li>
<li>
<p>
If the sync response counters are equal and nonce different, give a warning
</p>
</li>
<li>
<p>
If the sync response counter have higher than or equal values as val X internal database had at the moment of request creation a warning is logged.
</p>
</li>
<li>
<p>
The sync daemon updates the internal database to use the highest counter values: {{{UPDATE yubikeys SET counter = X, sessionUse = Y, high = P, low = Q, nonce = N, accessed = D WHERE publicName = ID AND counter &lt; X) OR (counter = X AND sessionUse &lt; Y}}}
</p>
</li>
<li>
<p>
The corresponding entry in the sync queue is removed.
</p>
</li>
</ol></div>
</li>
</ol></div>
</li>
</ol></div>
</div>
<div class="sect2">
<h3 id="_logging_matrix">Logging matrix</h3>
<div class="paragraph"><p>Available parameters in comparisons are the following.</p></div>
<table class="table table-bordered table-striped tableblock frame-all grid-all" style="
width:100%;
">
<col style="width:50%;">
<col style="width:50%;">
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">local</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local parameters at time of comparison</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">otp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameters from OTP provided in validation request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameters  in sync respone</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameters in sync request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local parameters when OTP vaildation request arrived</p></td>
</tr>
</tbody>
</col></col></table>
<div class="paragraph"><p>Parameters could be counters, modified, nonce.</p></div>
</div>
<div class="sect2">
<h3 id="_non_queued_sync_response_logging">Non-queued Sync response logging</h3>
<div class="paragraph"><p>We compare reponse parameters against validation parameters since we
are interested in if the server is in sync at the moment when the
validation request arrives.</p></div>
<table class="table table-bordered table-striped tableblock frame-all grid-all" style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top"> condition </th>
<th class="tableblock halign-left valign-top">level </th>
<th class="tableblock halign-left valign-top">action </th>
<th class="tableblock halign-left valign-top">message</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters &lt; validation.counters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote server out of sync.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters &gt; validation.counters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local server out of sync.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters = validation.counters and response.nonce != validation.nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Servers out of sync. Nonce differs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters = validation.counters and response.modified != validation.modified</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Servers out of sync. Modified differs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters &gt; otp.counters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OTP marked as invalid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OTP is replayed. Sync response counters higher than OTP counters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counter = otp.counters and response.nonce != otp.nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OTP marked as invalid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OTP is replayed. Sync response counters equal to OTP counters and nonce differs.</p></td>
</tr>
</tbody>
</col></col></col></col></table>
</div>
<div class="sect2">
<h3 id="_sync_request_logging">Sync request logging</h3>
<div class="paragraph"><p>Both an original sync and a queued sync looks the same so we can not
determine if the sync is original or queued. Therefore the logging is
the same in both cases.</p></div>
<table class="table table-bordered table-striped tableblock frame-all grid-all" style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top"> condition </th>
<th class="tableblock halign-left valign-top">level </th>
<th class="tableblock halign-left valign-top">message </th>
<th class="tableblock halign-left valign-top">note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">request.counters &lt; local.counters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote server out of sync.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">request.counters = local.counters and request.modified = local.modifed and request.nonce = local.nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sync request has been unnecessarily resent.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This could happen frequently whenever a syncentry is queued but the syncprocess terminates before the resonse to the syncentry arrives (since SL level was already achived).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">request.counters = local.counters and request.modified != local.modified and request.nonce = local.nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We might have a replay. 2 events at different times have generated the same counters. The time difference is X seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">request.counters = local.counters and request.nonce != local.nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote server has received a request to validate an already validated OTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
</tbody>
</col></col></col></col></table>
</div>
<div class="sect2">
<h3 id="_queued_sync_response_logging">Queued sync response logging</h3>
<div class="paragraph"><p>What do we want to warn for here. Out of sync at time of OTP
validation request or out of sync compared to current local counters?</p></div>
<table class="table table-bordered table-striped tableblock frame-all grid-all" style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top"> condition </th>
<th class="tableblock halign-left valign-top">level </th>
<th class="tableblock halign-left valign-top">message </th>
<th class="tableblock halign-left valign-top">note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters &lt; validation.counters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote server out of sync compared to counters at validation request time.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters &gt; validation.counters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local server out of sync compared to counters at validation request time.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters &lt; local.counters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote server out of sync compared to current local counters.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters &gt; local.counters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local server out of sync compared to current local counters. Local server updated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counters &gt; otp.counters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote server has higher counters than OTP. This response would have marked the OTP as invalid.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">response.counter = otp.counters and response.nonce != otp.nonce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote server has equal counters as OTP and nonce differs. This response would have marked the OTP as invalid.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
</tbody>
</col></col></col></col></table>
</div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>