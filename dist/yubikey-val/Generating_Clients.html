<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>Generating Clients</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/yubikey-val">yubikey-val</a></li>
<li class="active">Generating Clients</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/yubikey-val">yubikey-val</a><ul class="">
<li><a href="/yubikey-val/Release_Notes.html">Release Notes</a></li>
<li><a href="/yubikey-val/Installation.html">Installation</a></li>
<li><a href="/yubikey-val/Troubleshooting.html">Troubleshooting</a></li>
<li><a href="/yubikey-val/Client_Info_Format.html">Client Info Format</a></li>
<li class="active"><a href="/yubikey-val/Generating_Clients.html">Generating Clients</a>
<li><a href="/yubikey-val/Getting_Started_Writing_Clients.html">Getting Started Writing Clients</a></li>
<li><a href="/yubikey-val/Import_Export_Data.html">Import Export Data</a></li>
<li><a href="/yubikey-val/Make_Release.html">Make Release</a></li>
<li><a href="/yubikey-val/Munin_Probes.html">Munin Probes</a></li>
<li><a href="/yubikey-val/Revocation_Service.html">Revocation Service</a></li>
<li><a href="/yubikey-val/Server_Replication_Protocol.html">Server Replication Protocol</a></li>
<li><a href="/yubikey-val/Sync_Monitor.html">Sync Monitor</a></li>
<li><a href="/yubikey-val/Validation_Protocol_V2.0.html">Validation Protocol V2.0</a></li>
<li><a href="/yubikey-val/Validation_Server_Algorithm.html">Validation Server Algorithm</a></li>
<li><a href="/yubikey-val/YubiKey_Info_Format.html">YubiKey Info Format</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/yubikey-val" rel="noopener noreferrer" target="_blank"><i class="fa fa-github fa-lg"></i> Github</a></li>
</ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_generating_clients">Generating Clients</h1>
<div class="sectionbody">
<div class="paragraph"><p>For a client to be able to authenticate a YubiKey OTP with the Validation
service, a client ID and matching secret is needed (the secret is only
required for authenticated verification). To create a new client in the
database with a new generated secret, the ykval-gen-clients command can be
used. This document describes step by step instructions on generating and
using clients. For more information regarding the various fields of the
client database, see <a href="Client_Info_Format.html">Client Info Format</a>.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">There is no built-in method for synchronizing clients, if ykval-gen-clients
is used in a multi-server environment the clients will only exist on one
server.</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="_client_generation">Client generation</h3>
<div class="paragraph"><p>Use the command below to generate 5 clients. Note the usage of the --urandom
flag, which speeds up generation, but is less secure! The command is run
as root (using sudo), since it needs to be able to read the database
configuration stored in /etc/yubico/val/config-db.php.</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span>user@val:~$ sudo ykval-gen-clients --urandom <span class="m">5</span>

<span class="m">1</span>,l+/c/XfDPDHsaNKrpjwL+bf/Hgs<span class="o">=</span>
<span class="m">2</span>,LPGHqukoIAUGgDuOs7O0e1f8xD0<span class="o">=</span>
<span class="m">3</span>,K+gWRE0euOjVOiLD4Nm0wyHrHY8<span class="o">=</span>
<span class="m">4</span>,+8LF+ADANTAHnwB82xkBb+mNEFs<span class="o">=</span>
<span class="m">5</span>,URc6oabcuRV8OWW1Hs1cYym3ba4<span class="o">=</span>
user@val:~$
</pre></div></div></div>
</div>
<div class="sect2">
<h3 id="_testing_the_clients">Testing the clients</h3>
<div class="paragraph"><p>The above clients can now be used with the validation server. If you have
a YubiKey validation client, you can easily test this now. For example,
using the ykclient command (available in the ykclient-dev package, which is
in Debian as well as Ubuntu):</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span>user@val:~$ ykclient --url <span class="s2">"http://127.0.0.1/wsapi/2.0/verify?id=%d&amp;otp=%s"</span> --apikey <span class="nv">LPGHqukoIAUGgDuOs7O0e1f8xD0</span><span class="o">=</span> <span class="m">2</span> cccccccccccdutfiljtbignbgckhgdtfigbdricugdrv
Input:
  validation URL: http://127.0.0.1/wsapi/2.0/verify?id<span class="o">=</span>%d<span class="p">&amp;</span><span class="nv">otp</span><span class="o">=</span>%s
  client id: <span class="m">2</span>
  token: cccccccccccdutfiljtbignbgckhgdtfigbdricugdrv
  api key: <span class="nv">LPGHqukoIAUGgDuOs7O0e1f8xD0</span><span class="o">=</span>
Verification output <span class="o">(</span><span class="m">1</span><span class="o">)</span>: Yubikey OTP was bad <span class="o">(</span>BAD_OTP<span class="o">)</span>
user@val:~$
</pre></div></div></div>
<div class="paragraph"><p>Note that even though the response was BAD_OTP (since the key used is in fact
a bad OTP), the verification worked as expected. Compare it to the next example:</p></div>
<div class="listingblock">
<div class="content"><div class="highlight"><pre><span></span>user@val:~$ ykclient --url <span class="s2">"http://127.0.0.1/wsapi/2.0/verify?id=%d&amp;otp=%s"</span> --apikey not_a_real_secret <span class="m">3</span> cccccccccccdutfiljtbignggckhgdtfigbdricugdrvInput:
  validation URL: http://127.0.0.1/wsapi/2.0/verify?id<span class="o">=</span>%d<span class="p">&amp;</span><span class="nv">otp</span><span class="o">=</span>%s
  client id: <span class="m">3</span>
  token: cccccccccccdutfiljtbignggckhgdtfigbdricugdrv
  api key: not_a_real_secret
Verification output <span class="o">(</span><span class="m">106</span><span class="o">)</span>: Server response signature was invalid <span class="o">(</span>BAD_SERVER_SIGNATURE<span class="o">)</span>
user@val:~$
</pre></div></div></div>
<div class="paragraph"><p>In the above example, the server actually noticed that the client secret was
incorrect, and responded as it should. The response is signed with the correct
secret, which the client then interprets as invalid (since it thinks the
correct key is the dummy key we just gave it).</p></div>
</div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>