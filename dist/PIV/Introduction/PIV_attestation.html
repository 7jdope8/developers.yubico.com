<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>PIV attestation</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li class="active"><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li><a href="/PIV">PIV</a></li>
<li><a href="/PIV/Introduction">Introduction</a></li>
<li class="active">PIV attestation</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/PIV">PIV</a><ul class="">
<li class="active"><a href="/PIV/Introduction">Introduction</a><ul class="">
<li><a href="/PIV/Introduction/YubiKey_and_PIV.html">YubiKey and PIV</a></li>
<li><a href="/PIV/Introduction/Certificate_slots.html">Certificate slots</a></li>
<li><a href="/PIV/Introduction/Admin_access.html">Admin access</a></li>
<li><a href="/PIV/Introduction/Platform_support.html">Platform support</a></li>
<li class="active"><a href="/PIV/Introduction/PIV_attestation.html">PIV attestation</a>
<li><a href="/PIV/Introduction/Yubico_extensions.html">Yubico extensions</a></li>
</li></ul>
<li><a href="/PIV/Tools">Tools</a></li>
<li><a href="/PIV/Guides">Guides</a></li>
</li></ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/developers.yubico.com/issues/new?title=Suggested%20edit%20for%20PIV/Introduction/PIV_attestation" rel="noopener noreferrer" target="_blank"><i class="fa fa-pencil-square-o fa-lg"></i> Suggest Edits</a></li>
</ul>
</div>
<div id="page-content">
<div class="sect1">
<h1 id="_piv_attestation">PIV Attestation</h1>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction">Introduction</h3>
<div class="paragraph"><p>This document describes the attestation feature added to the PIV module in YubiKey 4.3. For actual commands to work with the attestation feature, please see the yubico-piv-tool <a href="/yubico-piv-tool/doc/Attestation.html">documentation</a>.</p></div>
</div>
<div class="sect2">
<h3 id="_purpose">Purpose</h3>
<div class="paragraph"><p>The concept of attestation is used to show that a certain asymmetric key has been generated on device and not imported. Typically this would be used before creating a certificate.</p></div>
</div>
<div class="sect2">
<h3 id="_implementation">Implementation</h3>
<div class="paragraph"><p>Attestation is implemented by creating a X.509 certificate for the key that is to be attested, this is only done if the key has been generated on device. This certificate should only be used for the purpose of verifying that the key was generated in device, not for any other purposes.</p></div>
<div class="paragraph"><p>Some features of the generated certificate:</p></div>
<div class="ulist"><ul>
<li>
<p>
Serial will be a random 16 byte integer
</p>
</li>
<li>
<p>
Issuer will be the subject of the attesting certificate
</p>
</li>
<li>
<p>
Dates will be copied from the attesting certificate
</p>
</li>
<li>
<p>
Subject will be the string "YubiKey PIV Attestation " with the attested slot appended
</p>
</li>
<li>
<p>
If the attesting key is RSA the signature will be SHA256-PKCS#1v1.5
</p>
</li>
<li>
<p>
If the attesting key is EC the signature will be ECDSA-SHA256
</p>
</li>
</ul></div>
<div class="paragraph"><p>Extensions in the generated certificate:</p></div>
<div class="ulist"><ul>
<li>
<p>
<span class="monospaced">1.3.6.1.4.1.41482.3.3</span>: Firmware version, encoded as 3 bytes, like: 040300 for 4.3.0
</p>
</li>
<li>
<p>
<span class="monospaced">1.3.6.1.4.1.41482.3.7</span>: Serial number of the YubiKey, encoded as an integer.
</p>
</li>
<li>
<p>
<span class="monospaced">1.3.6.1.4.1.41482.3.8</span>: Two bytes, the first encoding pin policy and the second touch policy
</p>
<div class="ulist"><ul>
<li>
<p>
Pin policy: 01 - never, 02 - once per session, 03 - always
</p>
</li>
<li>
<p>
Touch policy: 01 - never, 02 - always, 03 - cached for 15s
</p>
</li>
</ul></div>
</li>
<li>
<p>
<span class="monospaced">1.3.6.1.4.1.41482.3.9</span>: Formfactor, encoded as one byte
</p>
<div class="ulist"><ul>
<li>
<p>
USB-A Keychain: 01
</p>
</li>
<li>
<p>
USB-A Nano: 02
</p>
</li>
<li>
<p>
USB-C Keychain: 03
</p>
</li>
<li>
<p>
USB-C Nano: 04
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>The YubiKey comes with a pre-loaded attestation certificate signed by a <a href="piv-attestation-ca.pem">Yubico CA</a> this can be overwritten by loading a new key and certificate to slot f9. After the Yubico key is overwritten it can not be brought back. The attestation key and certificate will not be cleared out by a reset of the device.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph"><p>The root cert for the Yubico CA was updated on September 24, 2018. The prior PEM can be found <a href="piv-attestation-ca-old.pem">here</a>.</p></div>
<div class="paragraph"><p>For more information on support added to the current root certificate, see <a href="https://support.yubico.com/support/solutions/articles/15000013406-piv-attestation-verification-fails-with-openssl-1-1-0" rel="noopener noreferrer" target="_blank">PIV Attestation Verification Fails with OpenSSL 1.1.0</a>.</p></div>
</td>
</tr></table>
</div>
</div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" rel="noopener noreferrer" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" rel="noopener noreferrer" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" rel="noopener noreferrer" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" rel="noopener noreferrer" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" rel="noopener noreferrer" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" rel="noopener noreferrer" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" rel="noopener noreferrer" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" rel="noopener noreferrer" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" rel="noopener noreferrer" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" rel="noopener noreferrer" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" rel="noopener noreferrer" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" rel="noopener noreferrer" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" rel="noopener noreferrer" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>