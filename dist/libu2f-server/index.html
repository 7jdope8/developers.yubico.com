<!DOCTYPE html>

<!--[if lt IE 7]>    <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>     <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>     <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>libu2f-server</title>
<meta content="" name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<link href="/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/pygments.css" rel="stylesheet">
<link href="/css/asciidoc.css" rel="stylesheet">
<link href="/favicon-192x192.png" rel="icon" sizes="192x192">
<script src="/vendor/modernizr/modernizr.js"></script>
<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create', 'UA-6195355-4', 'auto');ga('send','pageview');
    </script>
</link></link></link></link></link></link></meta></meta></meta></meta></head>
<body>
<!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="/"><img src="/logo.png"/></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li><a href="/FIDO2">FIDO2</a></li><li><a href="/OTP">OTP</a></li><li><a href="/U2F">U2F</a></li><li><a href="/OATH">OATH</a></li><li><a href="/PGP">PGP</a></li><li><a href="/PIV">PIV</a></li><li><a href="/YubiHSM2">YubiHSM2</a></li><li><a href="/Software_Projects">Software Projects</a></li>
</ul>
<!-- Google Custom Search Engine -->
<div class="navbar-form navbar-right" id="search-box">
<script>
          (function() {
            var cx = '017198492754729237489:tcnraf8md8a';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
          </script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- End Google Custom Search Engine -->
</div><!--/.navbar-collapse -->
</div>
</div>
<div class="container">
<div class="row">
<ol class="breadcrumb">
<li><a href="/">Home</a></li>
<li class="active">libu2f-server</li>
</ol>
</div>
<div class="row">
<div class="col-md-4" style="padding-left: 0;">
<!-- Sidebar -->
<ul class="nav nav-side well well-sm">
<li class="active"><a href="/libu2f-server">libu2f-server</a><ul class="">
<li><a href="/libu2f-server/Release_Notes.html">Release Notes</a></li>
<li><a href="/libu2f-server/Manuals">Manuals</a></li>
<li><a href="/libu2f-server/Make_Release.html">Make Release</a></li>
</ul>
</li></ul>
<!-- End sidebar -->
</div>
<div class="col-md-8">
<!-- Main content -->
<div class="sidelinks">
<ul>
<li><a href="https://github.com/Yubico/libu2f-server" rel="noopener noreferrer" target="_blank"><i class="fa fa-github fa-lg"></i> Github</a></li>
</ul>
</div>
<div id="page-content"><h1>libu2f-server</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p><span class="image">
<img alt="License, link=https://opensource.org/licenses/BSD-2-Clause" src="https://img.shields.io/badge/License-BSD%202—Clause-orange.svg">
</img></span>
<span class="image">
<a class="image" href="https://travis-ci.org/Yubico/libu2f-server">
<img alt="Build Status" src="https://travis-ci.org/Yubico/libu2f-server.svg?branch=master">
</img></a>
</span>
<span class="image">
<a class="image" href="https://coveralls.io/r/Yubico/libu2f-server?branch=master">
<img alt="Coverage Status" src="https://coveralls.io/repos/Yubico/libu2f-server/badge.svg?branch=master">
</img></a>
</span>
<span class="image">
<img alt="" coverity="" src="https://scan.coverity.com/projects/5685/badge.svg" status""="">
</img></span></p></div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>This is a C library that implements the server-side of the U2F
protocol.  More precisely, it provides an API for generating the JSON
blobs required by U2F devices to perform the U2F Registration and U2F
Authentication operations, and functionality for verifying the
cryptographic operations.  For the host-side aspect, see our
<a href="https://developers.yubico.com/libu2f-host/">libu2f-host project</a>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_warning_and_known_limitation_attestation_certificate_validation">Warning and Known limitation: Attestation Certificate validation</h2>
<div class="sectionbody">
<div class="paragraph"><p>At registration time, an X.509 attestation certificate is provided.
Ideally the whole certificate chain should be validated. However, the
current version of this library does not do so.  This is a known
limitation, and we hope to address this as soon as possible.  Please
be sure to understand the implication of this before using the
library.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_versioning">Versioning</h2>
<div class="sectionbody">
<div class="paragraph"><p>The version numbers for this project follows the principles of
Semantic Versioning — see <a href="http://semver.org/">http://semver.org</a> — which,
briefly, uses the <span class="monospaced">MAJOR.MINOR.PATCH</span> scheme where <span class="monospaced">MAJOR</span> is bumped
in API-incompatible changes, <span class="monospaced">MINOR</span> is bumped for new features that are
backwards compatible, and <span class="monospaced">PATCH</span> is incremented when minor changes are done.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_usage">Usage</h2>
<div class="sectionbody">
<div class="paragraph"><p>There is a command line utility that is useful for debugging or
testing.  We describe how you can use it here.</p></div>
<div class="paragraph"><p>In order to perform a <strong>REGISTRATION</strong> operation, run the application
as follows:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ u2f-server -aregister -ohttp://demo.yubico.com \
  -i http://demo.yubico.com -k keyhandle.dat -p userkey.dat</pre>
</div></div>
<div class="paragraph"><p>This will generate a JSON registration blob like the following:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>{ "challenge": "cOQ-TBjhsbiAss7_hg2LhNNWxqjrRPWoSlThnQD6e2I",\
 "version":"U2F_V2", "appId": "http:\/\/demo.yubico.com" }</pre>
</div></div>
<div class="paragraph"><p>This can be used together with a client tool in order to
generate a registration response. One such tool is included in the
<a href="https://developers.yubico.com/libu2f-host/">libu2f-host project</a>.</p></div>
<div class="paragraph"><p>The tool can be invoked as follows:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ u2f-host -aregister -o http://demo.yubico.com</pre>
</div></div>
<div class="paragraph"><p>The previous JSON blob should now be pasted into the standard input of the
u2f-host application and an <span class="monospaced">EOF</span> character should be sent (<span class="monospaced">Ctrl-D</span> on Linux).</p></div>
<div class="paragraph"><p>At this point your device should start flashing, waiting for an input.
Touching the gold disk will allow you to proceed.</p></div>
<div class="paragraph"><p>A JSON registration response will now be generated by u2f-host.
It will look something like this:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>{ "registrationData": "BQQcsmA1brUvrNgntjvKrCzUIIN92Y61ee\
DI7xnEVliksvO8l0aVY0HcASqf5dExipOVHTfxYVImZ_M3U4eAjt-OQCt\
h1BOT0gr3HLkLJcid1Ahks8NyjeyfkoLLES-i4Fn650vkgE7jTOnCGiuC\
nZzpkZ2exkwLWhNW2QZA1nAaS4owggIbMIIBBaADAgECAgR1o_Z1MAsGC\
SqGSIb3DQEBCzAuMSwwKgYDVQQDEyNZdWJpY28gVTJGIFJvb3QgQ0EgU2\
VyaWFsIDQ1NzIwMDYzMTAgFw0xNDA4MDEwMDAwMDBaGA8yMDUwMDkwNDA\
wMDAwMFowKjEoMCYGA1UEAwwfWXViaWNvIFUyRiBFRSBTZXJpYWwgMTk3\
MzY3OTczMzBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABBmjfkNqa2mXz\
Vh2ZxuES5coCvvENxDMDLmfd-0ACG0Fu7wR4ZTjKd9KAuidySpfona5cs\
GmlM0Te_Zu35h_wwujEjAQMA4GCisGAQQBgsQKAQIEADALBgkqhkiG9w0\
BAQsDggEBAb0tuI0-CzSxBg4cAlyD6UyT4cKyJZGVhWdtPgj_mWepT3Tu\
9jXtdgA5F3jfZtTc2eGxuS-PPvqRAkZd40AXgM8A0YaXPwlT4s0RUTY9Y\
8aAQzQZeAHuZk3lKKd_LUCg5077dzdt90lC5eVTEduj6cOnHEqnOr2Cv7\
5FuiQXX7QkGQxtoD-otgvhZ2Fjk29o7Iy9ik7ewHGXOfoVw_ruGWi0YfX\
BTuqEJ6H666vvMN4BZWHtzhC0k5ceQslB9Xdntky-GQgDqNkkBf32GKwA\
FT9JJrkO2BfsB-wfBrTiHr0AABYNTNKTceA5dtR3UVpI492VUWQbY3YmW\
UUfKTI7fM4wRQIhAJNrBRxUWPwdVWFpuutWd78ESaoZFXvK2yvUzm14cP\
vQAiBFSn-5J6LvJAstgSFLD-1vWXANqrJ7-5yoIqT6fOj9JQ==", "cli\
entData": "eyAiY2hhbGxlbmdlIjogImNPUS1UQmpoc2JpQXNzN19oZz\
JMaE5OV3hxanJSUFdvU2xUaG5RRDZlMkkiLCAib3JpZ2luIjogImh0dHA\
6XC9cL2RlbW8ueXViaWNvLmNvbSIsICJ0eXAiOiAibmF2aWdhdG9yLmlk\
LmZpbmlzaEVucm9sbG1lbnQiIH0=" }</pre>
</div></div>
<div class="paragraph"><p>This should now be pasted back into the u2f-server application
which will report either a successful or a failed registration.
In the first case the user public key and the key-handle
associated with the operation will be written in the two files
specified at invocation time (userkey.dat and keyhandle.dat
respectively in this example).</p></div>
<div class="paragraph"><p>In order to perform an <strong>AUTHENTICATION</strong> operation, run the application
as follows:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ u2f-server -aauthenticate -ohttp://demo.yubico.com \
  -i http://demo.yubico.com -k keyhandle.dat -p userkey.dat</pre>
</div></div>
<div class="paragraph"><p>The two files keyhandle.dat and userkey.dat must contain a
key-handle and user public key respectively. These can be obtained
by performing the registration process described above.</p></div>
<div class="paragraph"><p>The tool will then generate a JSON authentication blob like the following:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>{ "keyHandle": "K2HUE5PSCvccuQslyJ3UCGSzw3KN7J-SgssRL6LgWfrnS-SATu\
NM6cIaK4KdnOmRnZ7GTAtaE1bZBkDWcBpLig", "version": "U2F_V2", "chall\
enge": "NRQNFRTLNLKtJzUsIPe12Aw1uzjIdSBotm0j_gYbpXQ", "appId": "ht\
tp:\/\/demo.yubico.com" }</pre>
</div></div>
<div class="paragraph"><p>This can be used together with a client tool in order to
generate an authentication response. One such tool is included in the
<a href="https://developers.yubico.com/libu2f-host/">libu2f-host project</a>.</p></div>
<div class="paragraph"><p>The tool can be invoked as follows:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ u2f-host -aauthenticate -o http://demo.yubico.com</pre>
</div></div>
<div class="paragraph"><p>The previous JSON blob should now be pasted into the standard input of the
u2f-host application and an <span class="monospaced">EOF</span> character should be sent (<span class="monospaced">Ctrl-D</span> on Linux).</p></div>
<div class="paragraph"><p>At this point your device should start flashing, waiting for an input.
Touching the gold disk will allow you to proceed.</p></div>
<div class="paragraph"><p>A JSON authentication response will now be generated by u2f-host.
It will look something like this:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>{ "signatureData": "AQAAAC0wRQIgc3fteZpmsA0AbNDMIglup1b5jRPVUUr0\
PDz_ZTq7lD4CIQCAGCkREjVFRVIOGIs43dspMxgVjENGE3gm8G3VNdc61w==", "\
clientData": "eyAiY2hhbGxlbmdlIjogIk5SUU5GUlRMTkxLdEp6VXNJUGUxMk\
F3MXV6aklkU0JvdG0wal9nWWJwWFEiLCAib3JpZ2luIjogImh0dHA6XC9cL2RlbW\
8ueXViaWNvLmNvbSIsICJ0eXAiOiAibmF2aWdhdG9yLmlkLmdldEFzc2VydGlvbi\
IgfQ==", "keyHandle": "K2HUE5PSCvccuQslyJ3UCGSzw3KN7J-SgssRL6LgW\
frnS-SATuNM6cIaK4KdnOmRnZ7GTAtaE1bZBkDWcBpLig" }</pre>
</div></div>
<div class="paragraph"><p>This should now be pasted back into the u2f-server application
which will report either a successful or a failed authentication.
For successful authentication the counter value and the user
presence value will be printed as well.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_building">Building</h2>
<div class="sectionbody">
<div class="paragraph"><p>This project has a handful of Dependencies that must be satisfied prior to
build — consult <code>build-aux/travis</code> for insights if you run into issues.</p></div>
<div class="paragraph"><p>Autotools are required, this includes <code>autoconf</code>, <code>automake</code> and <code>libtool</code>,
<code>check</code>  is only required for tests, and the library will build with out.</p></div>
<div class="paragraph"><p>Debian:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>  # apt-get install check gengetopt help2man libssl-dev libjson-c-dev</pre>
</div></div>
<div class="paragraph"><p>RHEL:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>  # yum install check-devel gengetopt help2man openssl-devel json-c-devel</pre>
</div></div>
<div class="paragraph"><p>macOS:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>  $ brew install check gengetopt help2man json-c openssl pkg-config
  $ export PKG_CONFIG_PATH=$(brew --prefix openssl)/lib/pkgconfig</pre>
</div></div>
<div class="paragraph"><p>Building from a release tarball:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>  $ ./configure --enable-tests
  $ make &amp;&amp; make check
  # make install</pre>
</div></div>
<div class="paragraph"><p>From source:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>  $ ./autogen.sh
  $ ./configure --enable-tests
  $ make &amp;&amp; make check
  # make install</pre>
</div></div>
</div>
</div>
</div>
<!-- End main content -->
</div>
</div>
</div>
<footer class="container">
<div class="row" style="margin-top:30px;padding-top:20px;border-top:1px solid #eee;">
<div class="col-md-3">
<p style="line-height:2em;font-size:90%">
<strong><a href="https://developers.yubico.com/" style="color:#000">DEV.YUBICO</a></strong><br>
<a href="/FIDO2">FIDO2</a><br>
<a href="/OTP">OTP</a><br>
<a href="/U2F">U2F</a><br>
<a href="/OATH">OATH</a><br>
<a href="/PGP">PGP</a><br>
<a href="/PIV">PIV</a><br>
<a href="/YubiHSM2">YubiHSM2</a><br>
<a href="/Software_Projects">Software Projects</a><br>
</br></br></br></br></br></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong>RESOURCES</strong><br>
<a href="https://store.yubico.com/" target="_blank">Buy YubiKeys</a><br>
<a href="https://www.yubico.com/blog/" target="_blank">Blog</a><br>
<a href="https://www.yubico.com/newsletter/" target="_blank">Newsletter</a><br>
<a href="http://forum.yubico.com/" target="_blank">Yubico Forum Archive</a></br></br></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:2em;font-size:90%"><strong><a href="https://www.yubico.com/" style="color:#000" target="_blank">YUBICO.COM</a></strong><br>
<a href="https://www.yubico.com/why-yubico/" target="_blank">Why Yubico</a><br>
<a href="https://www.yubico.com/about/about-us/" target="_blank">About Yubico</a></br></br></p>
</div>
<div class="col-md-3">
<p style="line-height:1em;font-size:90%"> </p>
<table align="right" cellpadding="0" cellspacing="0" style="color:#9aca3c">
<tbody>
<tr>
<td style="padding:10px"><a href="https://www.yubico.com/feed/" target="_blank" title="Blog RSS"><i class="fa fa-rss"></i></a></td>
<td style="padding:10px"><a href="https://twitter.com/yubico" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>
<td style="padding:10px"><a href="https://plus.google.com/114531431015898699937" target="_blank" title="Google Plus"><i class="fa fa-google-plus"></i></a></td>
<td style="padding:10px"><a href="https://www.facebook.com/Yubikey" target="_blank" title="Facebook"><i class="fa fa-facebook"></i></a></td>
<td style="padding:10px"><a href="https://www.youtube.com/c/Yubico" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>
<td style="padding:10px 0 10px 10px"><a href="https://github.com/Yubico" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</footer>
<!-- Offset anchor links for navbar -->
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
  </script>
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
</body>
</html>