== Introduction
Compromised credentials continue to be the top risk for data breaches. Many online services still use a password as the single factor to authenticate users. Some have moved to two-factor authentication (2FA) but have faced user experience challenges and found that weak 2FA options are still vulnerable to phishing attacks. Enterprises and online services need a simple, secure, and scalable user authentication solution. 

=== Problems with traditional credentials
* Strong passwords can be difficult to remember, and users often reuse passwords on multiple sites
* Server breaches can expose symmetric network credentials (passwords)
* Passwords are subject to replay attacks
* Users can inadvertently expose their passwords due to phishing attacks.

FIDO2 offers a strong multi-factor authentication framework to replace passwords with scoped public key-based credentials that are resistant to phishing, replay, and server breach attacks. User gestures such as PINs, touch, or biometrics are used to authorize use of FIDO2 credentials. 

== FIDO2 Authentication
The FIDO2 Authentication is the new standard to replace weak password-based authentication with strong hardware-based authentication using public key (asymmetric) cryptography.

image::fido2_building_blocks.png[]

FIDO2 is built on top of two open standards, a Web Authentication API (WebAuthn) and a Client to Authenticator Protocol (CTAP2). The two work together and are required to achieve a passwordless experience for login. The earlier FIDO U2F protocol working with external authenticators is now renamed to CTAP1 in the WebAuthn specifications. FIDO2 is backwards compatible with U2F.

image::fido2_app_architecture.png[]

In general, a FIDO2 authentication architecture involves a conversation between a computing environment controlled by a Relying Party and one controlled by the user to be authenticated. The Relying Party's environment consists conceptually of at least a web server and the server-side portions of a web application, plus a WebAuthn server. The WebAuthn server has a trust store, containing the (public) trust anchors for the attestation of FIDO2 Authenticators. The users' environment, referred to as the FIDO2 user device, consists of one or more FIDO2 Authenticators and a FIDO2 Client. The FIDO2 Client may be a browser hosting a web application delivered by the Relying Party, or it may be a standalone application delivered by the Relying Party. The client communicates with the authenticator through a library that speaks CTAP2. This library can be built into the operating system or the application, e.g. browser.

FIDO2 Authenticators, such as a Security Key by Yubico, provide strong multi-factor authentication and can replace password with the combination of a specific device, and a PIN or biometric gesture. During registration with an online service, the authenticator creates a new key pair. It retains the private key and registers the public key with the online service. Authentication is done by the authenticator proving possession of the private key to the service by signing a challenge. The authenticator’s private keys can be used only after they are unlocked by the user. The unlock is accomplished by a user–friendly and secure action such as inserting a security key, entering a PIN, or touching a button.

=== Key Points
* FIDO2 credentials are based on an asymmetrical key pair.
* Identity providers validate user identity and map a FIDO2 credential public key to a user account during the registration step
* Keys can be generated in hardware (Security Key by Yubico) or software, based on policy.
* Authentication is a combination of a key tied to a device and something that the person knows (a PIN) or something that the person is (biometric gesture). PINs and biometric gestures do not roam between devices and are not shared with the server, they are stored locally on a device.
* Private key never leaves a device. The authenticating server has a public key that is mapped to the user account during the registration process.
* PIN entry, biometric gesture, or touch trigger the device to unlock the private key to cryptographically sign data that is sent to the identity provider. The identity provider verifies the user’s identity and authenticates the user.

== Implementation Considerations
There are various scenarios where we can implement FIDO2 Authentication. For example, a WebAuthn library can be integrated into the authentication server for an online service. In the case of federated identities, the relying party can request phishing resistant authentication from an identity provider that implements WebAuthn. Another common scenario is logging into your app on a device, e.g. a password manager application.


=== Common Use Cases
* Online second-factor authentication
* Online passwordless authentication
* Online multi-factor authentication
* Native application/platform logon 
* Offline vault protection

WebAuthn has two basic methods that correspond to registration and authentication:

* navigator.credentials.create() - takes a publicKey option and creates new credentials for the registration of a new account.
* navigator.credentials.get() - takes a publicKey option and uses an existing set of credentials to authenticate to a service.
